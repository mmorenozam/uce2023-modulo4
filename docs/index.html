<!DOCTYPE html>
<html lang="en"><head>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/tabby.min.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.280">

  <meta name="author" content="Mauricio Moreno, PhD">
  <title>uce2023-modulo4 - Estad√≠stica aplicada con R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/reveal-pointer/pointer.css" rel="stylesheet">
  <link href="site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="site_libs/tabwid-1.1.3/tabwid.css" rel="stylesheet">
  <script src="site_libs/tabwid-1.1.3/tabwid.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="images/logo.jpeg" data-background-opacity="0.2" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Estad√≠stica aplicada con R</h1>
  <p class="subtitle">M√≥dulo 4: Herramientas Estad√≠sticas</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Mauricio Moreno, PhD 
</div>
</div>
</div>

</section>
<section>
<section id="definiciones-b√°sicas" class="title-slide slide level1 center">
<h1>Definiciones b√°sicas</h1>

</section>
<section id="antes-de-comenzar" class="slide level2">
<h2>Antes de comenzar</h2>
<div>
<ul>
<li class="fragment"><p>Uno de los objetivos de este curso es el evitar en la medida de lo posible el adentrarnos en teor√≠a estad√≠stica. Entre los temas que dejaremos de lado est√°n:</p>
<ul>
<li class="fragment"><p>Teor√≠a de la probabilidad b√°sica</p></li>
<li class="fragment"><p>Descripci√≥n a detalle de la distribuci√≥n normal</p></li>
<li class="fragment"><p>Descripci√≥n a detalle de otras distribuciones</p></li>
</ul></li>
<li class="fragment"><p>Sin embargo, es preciso el comenzar por algunas definiciones que inevitablemente ser√°n necesarias para entender de mejor manera el resto del mismo.</p></li>
</ul>
</div>
<div class="footer">
<p>Para qui√©n est√© interesado en un recurso para ver estos temas a profundidad, recomiendo el libro de <a href="https://learningstatisticswithr.com/" target="_blank">Danielle Navarro: <em>Learning Statistics with R</em></a></p>
</div>
</section>
<section id="muestras-poblaciones-y-muestreos" class="slide level2">
<h2>Muestras, poblaciones y muestreos</h2>
<div>
<ul>
<li class="fragment"><p><strong>Muestra</strong>: Es un conjunto de observaciones que provienen de una poblaci√≥n de inter√©s. Idealmente, esta deber√≠a ser lo suficientemente grande para hacer inferencias de esa poblaci√≥n.</p></li>
<li class="fragment"><p><strong>Poblaci√≥n</strong>: Es el conjunto de todas las posibles observaciones de las que tengamos inter√©s en realizar inferencias. Es vital el definir adecuadamente sus caracter√≠sticas.</p></li>
<li class="fragment"><p><strong>Muestreo</strong>: Es el proceso por el cual obtendremos nuestra muestra para un estudio. En estudios experimentales, el muestreo se entiende tambi√©n como el proceso de aleatorizaci√≥n/randomizaci√≥n de unidades experimentales.</p></li>
</ul>
</div>
</section>
<section id="muestreo-simple-sin-reemplazo" class="slide level2">
<h2>Muestreo simple sin reemplazo</h2>

<img data-src="images/simple1.png" class="quarto-discovered-preview-image r-stretch quarto-figure-center" width="900"><p class="caption">Tomado de <a href="https://learningstatisticswithr.com/" target="_blank"><em>Learning Statistics with R</em></a></p></section>
<section id="muestreo-simple-con-reemplazo" class="slide level2">
<h2>Muestreo simple con reemplazo</h2>

<img data-src="images/simple2.png" width="1020" class="r-stretch quarto-figure-center"><p class="caption">Tomado de <a href="https://learningstatisticswithr.com/" target="_blank"><em>Learning Statistics with R</em></a></p></section>
<section id="otros-tipos-de-muestreo" class="slide level2">
<h2>Otros tipos de muestreo</h2>
<div>
<ul>
<li class="fragment"><p><strong>Muestreo sistem√°tico</strong>: consiste en tomar un determinado elemento de la poblaci√≥n siguiendo un patr√≥n. Por ejemplo, escoger los m√∫ltiplos de cuatro enumerados en una lista de posibles individuos de estudio (sol√≠a ser una pr√°ctica com√∫n en ensayos cl√≠nicos).</p></li>
<li class="fragment"><p><strong>Muestreo a conveniencia</strong>: consiste en incluir en el estudio a todos los elementos disponibles de la poblaci√≥n de inter√©s. Esto sucede sobre todo con poblaciones escasas o de dificil acceso (ejemplo, realizar estudios en comunidades LGBTIQ+).</p></li>
<li class="fragment"><p><strong>Muestreo estratificado</strong>: es una combinaci√≥n del muestreo simple con los sujetos agrupados por alguna caracter√≠stica en com√∫n, por ejemplo sexo, edad, h√°bitat (suele ser usado en exit polls y conteos r√°pidos).</p></li>
</ul>
</div>
</section>
<section id="par√°metros-poblacionales-y-estad√≠sticos-muestrales" class="slide level2">
<h2>Par√°metros poblacionales y estad√≠sticos muestrales</h2>
<div>
<ul>
<li class="fragment"><p>Los par√°metros poblacionales son caracter√≠sticas de toda una poblaci√≥n (ejemplo, supongamos que el IQ de toda una poblaci√≥n puede estar caracterizado por una media aritm√©tica, <span class="math inline">\(\mu\)</span>, igual a 100, con una desviaci√≥n est√°ndar, <span class="math inline">\(\sigma\)</span>, igual a 15).</p></li>
<li class="fragment"><p>Si tomo una muestra de 100 individuos de dicha poblaci√≥n, podr√≠a tener una media aritm√©tica de esta muestra, <span class="math inline">\(\overline{X}\)</span>, igual a 101.4 y una desviaci√≥n est√°ndar de la muestra, <span class="math inline">\(s\)</span>, igual a 13.7.</p></li>
<li class="fragment"><p>En otras palabras, la <span class="math inline">\(\overline{X}\)</span> y <span class="math inline">\(s\)</span> son aproximaciones a los valores verdareros de <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> de esa poblaci√≥n.</p></li>
</ul>
</div>
</section>
<section id="ley-de-los-n√∫meros-grandes" class="slide level2">
<h2>Ley de los n√∫meros grandes</h2>
<div>
<ul>
<li class="fragment"><p>La ley de los n√∫meros grandes establece que a medida que aumenta el tama√±o de una muestra, <span class="math inline">\(\overline{X}\)</span> y <span class="math inline">\(s\)</span> estar√°n m√°s y m√°s cerca de los valores verdaderos <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span>.</p></li>
<li class="fragment"><p>Esta es una de las razones por las cuales en la conducci√≥n de experimentos siempre se aconseja el intentar recabar tantas observaciones sea posible.</p></li>
</ul>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>IQ1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">mean</span>(IQ1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 101.3561</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">sd</span>(IQ1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 13.69224</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>IQ2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100000</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">15</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">mean</span>(IQ2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100.0147</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="fu">sd</span>(IQ2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14.996</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="distribuci√≥n-de-muestreo" class="slide level2 smaller">
<h2>Distribuci√≥n de muestreo</h2>
<div>
<ul>
<li class="fragment"><p>La idea de poder medir enormes n√∫meros de individuos es irreal.</p></li>
<li class="fragment"><p>Sin embargo, consideremos el siguiente escenario: si en lugar de medir el IQ de 100000 personas, repito el experimento una y otra vez pero en grupos de 5, puedo observar que la <em>distribuci√≥n de las medias aritm√©ticas</em> de todos estos experimentos adopta la forma de una distribuci√≥n normal</p></li>
</ul>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/sampling_hist.gif" width="400"></p>
</figure>
</div>
</div>
</section>
<section id="distribuci√≥n-de-muestreo-1" class="slide level2" data-visibility="uncounted">
<h2>Distribuci√≥n de muestreo</h2>
<div>
<ul>
<li class="fragment"><p>Esta distribuci√≥n toma el nombre <strong>distribuci√≥n de muestreo de la media aritm√©tica</strong>.</p></li>
<li class="fragment"><p>Lo que nos demuestra es que, incluso ante reducidos n√∫meros de observaciones en una muestra, la media aritm√©tica de esta muestra (<span class="math inline">\(\overline{X}\)</span>) estar√° pr√≥xima a la media aritm√©tica verdadera de la poblaci√≥n (<span class="math inline">\(\mu\)</span>).</p></li>
</ul>
</div>
<div class="fragment">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/table1.png" width="550"></p>
<p></p><figcaption>Tomado de <a href="https://learningstatisticswithr.com/" target="_blank"><em>Learning Statistics with R</em></a></figcaption><p></p>
</figure>
</div>
</div>
</section>
<section id="teorema-del-l√≠mite-central" class="slide level2 smaller">
<h2>Teorema del l√≠mite central</h2>
<div>
<ul>
<li class="fragment"><p>El teorema del l√≠mite central establece que siempre que el n√∫mero de observaciones sea lo suficientemente grande, la distribuci√≥n de muestreo de la media aritm√©tica tender√° a ser normal independientemente de si la distribuci√≥n de las observaciones es normal o no.</p></li>
<li class="fragment"><p>Ejemplo: supongamos que el ancho del caparaz√≥n de una especie de tortugas est√° comprendido entre 4 y 10 cent√≠metros. En otras palabras, si observamos al azar una tortuga de esta poblaci√≥n, sabemos que el ancho del caparaz√≥n estar√° en este rango. En t√©rminos de una distribuci√≥n, podemos decir que el ancho del caparaz√≥n en una poblaci√≥n de 1000 tortugas podr√≠a verse de esta manera:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-3-1.png" width="480"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="teorema-del-l√≠mite-central-1" class="slide level2" data-visibility="uncounted">
<h2>Teorema del l√≠mite central</h2>

<img data-src="images/sampling_hist1.gif" width="600" class="r-stretch quarto-figure-center"></section>
<section id="teorema-del-l√≠mite-central-2" class="slide level2" data-visibility="uncounted">
<h2>Teorema del l√≠mite central</h2>
<div>
<ul>
<li class="fragment"><p>Es gracias al teorema del l√≠mite central que la mayor parte de m√©todos estad√≠sticos giran alrededor de la normalidad.</p></li>
<li class="fragment"><p>Sin embargo, c√≥mo ya hemos mencionado, requiere a veces de un considerable n√∫mero de observaciones para que se cumpla y no todas las veces esto es posible en la pr√°ctica.</p></li>
<li class="fragment"><p>Por ello, en el desarrollo del curso iremos mostrando ejemplos de cuando esto no ocurre y que medidas podemos tomar en tales casos.</p></li>
</ul>
</div>
</section>
<section id="estimaci√≥n-de-par√°metros-de-poblaci√≥n" class="slide level2">
<h2>Estimaci√≥n de par√°metros de poblaci√≥n</h2>
<p><strong>Media aritm√©tica</strong></p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 52%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>S√≠mbolo</th>
<th>¬øQu√© es?</th>
<th>¬øSabemos qu√© es?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\overline{X}\)</span></td>
<td>Media aritm√©tica de la muestra</td>
<td>Calculada de los datos</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mu\)</span></td>
<td>Verdadera media aritm√©tica de la poblaci√≥n</td>
<td>Casi nunca es conocida</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\mu}\)</span></td>
<td>Estimado de la media aritm√©tica de la poblaci√≥n</td>
<td>S√≠, identica a <span class="math inline">\(\overline{X}\)</span></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\overline{X} = \frac{1}{n}\sum^{n}_{i=1}\left(X_i\right)
\]</span></p>
</section>
<section id="estimaci√≥n-de-par√°metros-de-poblaci√≥n-1" class="slide level2" data-visibility="uncounted">
<h2>Estimaci√≥n de par√°metros de poblaci√≥n</h2>
<p><strong>Desviaci√≥n est√°ndar</strong></p>
<table>
<colgroup>
<col style="width: 13%">
<col style="width: 55%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th>S√≠mbolo</th>
<th>¬øQu√© es?</th>
<th>¬øSabemos qu√© es?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s\)</span></td>
<td>Desviaci√≥n est√°ndar de la muestra</td>
<td>Calculada de los datos</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma\)</span></td>
<td>Verdadera desviaci√≥n est√°ndar de la poblaci√≥n</td>
<td>Casi nunca es conocida</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\sigma}\)</span></td>
<td>Estimado de la deviaci√≥n est√°ndar de la poblaci√≥n</td>
<td>S√≠, pero no es igual a <span class="math inline">\(s\)</span></td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
s = \sqrt{\frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2}
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
\sigma = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2}
\]</span></p>
</div>
</div>
</section>
<section id="estimaci√≥n-de-par√°metros-de-poblaci√≥n-2" class="slide level2" data-visibility="uncounted">
<h2>Estimaci√≥n de par√°metros de poblaci√≥n</h2>
<p><strong>Varianza</strong></p>
<table>
<colgroup>
<col style="width: 14%">
<col style="width: 48%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>S√≠mbolo</th>
<th>¬øQu√© es?</th>
<th>¬øSabemos qu√© es?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(s^2\)</span></td>
<td>Varianza de la muestra</td>
<td>Calculada de los datos</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\sigma^2\)</span></td>
<td>Verdadera varianza de la poblaci√≥n</td>
<td>Casi nunca es conocida</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td>Estimado de la varianza de la poblaci√≥n</td>
<td>S√≠, pero no es igual a <span class="math inline">\(s^2\)</span></td>
</tr>
</tbody>
</table>
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math display">\[
s^2 = \frac{1}{n} \sum_{i=1}^n (X_i - \overline{X})^2
\]</span></p>
</div><div class="column" style="width:50%;">
<p><span class="math display">\[
\sigma^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2
\]</span></p>
</div>
</div>
</section>
<section id="intervalos-de-confianza" class="slide level2 smaller">
<h2>Intervalos de confianza</h2>
<div>
<ul>
<li class="fragment"><p>C√≥mo hemos visto, los estimados de las verdaderas <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> (<span class="math inline">\(\hat{\mu}\)</span> y <span class="math inline">\(\hat{\sigma}\)</span>) provienen de distribuciones de muestreo, y como tales, inherentemente poseen cierto grado de incertidumbre.</p></li>
<li class="fragment"><p>Los intervalos de confianza son medidas que nos permiten tener una idea de esa incertidumbre.</p></li>
<li class="fragment"><p>En el estudio de la distribuci√≥n normal est√°ndar tenemos el conocimiento que existe un 95% de chances que una cantidad normalmente distribuida colectada al azar, estar√° distante de la media aritm√©tica entre <span class="math inline">\(\pm\)</span> 1.96 desviaciones est√°ndar.</p></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
\overline{X} - \left(1.96\times\frac{\sigma}{\sqrt{n}}\right) \leq \mu \leq \overline{X} + \left(1.96\times\frac{\sigma}{\sqrt{n}}\right)
\]</span></p>
<div>
<ul>
<li class="fragment">Y se interpreta como: <strong>con un 95% de confianza, podemos esperar que la media aritm√©tica verdadera de la poblaci√≥n de inter√©s se encuentra contenida entre‚Ä¶</strong></li>
</ul>
</div>
</div>
<div class="fragment">
<p><span class="math display">\[
\text{IC}_{95}=\overline{X} \pm \left(1.96\times\frac{\sigma}{\sqrt{n}}\right)
\]</span></p>
</div>
</section>
<section id="intervalos-de-confianza-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Intervalos de confianza</h2>
<div>
<ul>
<li class="fragment"><p>Sin embargo, como mencionamos <span class="math inline">\(\sigma\)</span> es casi nunca conocido, y es necesario hacer una correcci√≥n a la f√≥rmula anterior. La distribuci√≥n normal trabaja bien baja la presunci√≥n de un numero grande de observaciones.</p></li>
<li class="fragment"><p>En su lugar, en 1908 el estad√≠stico <a href="https://en.wikipedia.org/wiki/Student%27s_t-distribution" target="_blank">Gosset</a> parametriz√≥ una distribuci√≥n para muestras peque√±as que asemeja a la normal. Con el tiempo, esta distribuci√≥n adopt√≥ el nombre de <em>Student</em>.</p></li>
<li class="fragment"><p>Y es precisamente que la f√≥rmula anterior es corregida con la distribuci√≥n de Student y as√≠ poder calcular intervalos de confianza para muestras peque√±as usando <span class="math inline">\(s\)</span> en lugar de <span class="math inline">\(\sigma\)</span>:</p></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
\text{IC}_{95}=\overline{X} \pm \left(t_{n-1,\alpha/2}\times\frac{s}{\sqrt{n}}\right)
\]</span></p>
<div>
<ul>
<li class="fragment"><p>Donde el valor <span class="math inline">\(t_{n-1,\alpha/2}\)</span> refiere a:</p>
<ul>
<li class="fragment"><p><span class="math inline">\(n-1\)</span>: los grados de libertad, igual al n√∫mero de observaciones <span class="math inline">\(n\)</span> de la muestra, menos 1</p></li>
<li class="fragment"><p><span class="math inline">\(\alpha\)</span>: es el nivel de significancia (probabilidad de obtener un resultado err√≥neo por azar).</p></li>
<li class="fragment"><p>Estos valores en el pasado se encontraban tabulados en libros de texto, hoy contamos con R!</p></li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="intervalos-de-confianza-2" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Intervalos de confianza</h2>
<div>
<ul>
<li class="fragment">Regresando al ejemplo del IQ, supongamos que medimos al azar el IQ de 5 personas y deseamos calcular el <span class="math inline">\(\text{IC}_{95}\)</span></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb9" data-code-line-numbers="1|2|3|4|5|6|7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>IQ_muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">98</span>, <span class="dv">116</span>, <span class="dv">96</span>, <span class="dv">129</span>)   <span class="co"># muestra</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span>                                   <span class="co"># n√∫mero de observaciones</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>t95 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> n <span class="sc">-</span><span class="dv">1</span>)          <span class="co"># valor de Student para 4 grados de libertad al 5%</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>x <span class="ot">&lt;-</span> <span class="fu">mean</span>(IQ_muestra)                    <span class="co"># media aritm√©tica de la muestra</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(IQ_muestra)                      <span class="co"># desviaci√≥n est√°ndar de la muestra</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>ls <span class="ot">&lt;-</span> x <span class="sc">+</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># l√≠mite superior del IC95</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>li <span class="ot">&lt;-</span> x <span class="sc">-</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># l√≠mite inferior del IC95</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="intervalos-de-confianza-3" class="slide level2" data-autoanimate="true" data-visibility="uncounted">
<h2>Intervalos de confianza</h2>
<ul>
<li>Regresando al ejemplo del IQ, supongamos que medimos al azar el IQ de 5 personas y deseamos calcular el <span class="math inline">\(\text{IC}_{95}\)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10" data-code-line-numbers="8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>IQ_muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">98</span>, <span class="dv">116</span>, <span class="dv">96</span>, <span class="dv">129</span>)   <span class="co"># muestra</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span>                                   <span class="co"># n√∫mero de observaciones</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>t95 <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> n <span class="sc">-</span><span class="dv">1</span>)          <span class="co"># valor de Student para 4 grados de libertad al 5%</span></span>
<span id="cb10-4"><a href="#cb10-4"></a>x <span class="ot">&lt;-</span> <span class="fu">mean</span>(IQ_muestra)                    <span class="co"># media aritm√©tica de la muestra</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(IQ_muestra)                      <span class="co"># desviaci√≥n est√°ndar de la muestra</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>ls <span class="ot">&lt;-</span> x <span class="sc">+</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># l√≠mite superior del IC95</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>li <span class="ot">&lt;-</span> x <span class="sc">-</span> (t95<span class="sc">*</span>s<span class="sc">/</span>(n<span class="dv">-1</span>))                  <span class="co"># l√≠mite inferior del IC95</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">"Con un 95% de confianza podemos esperar que la verdadera media aritm√©tica de IQ de esta poblaci√≥n se encuentre entre ["</span>,<span class="fu">round</span>(li,<span class="dv">0</span>),<span class="st">", "</span>,<span class="fu">round</span>(ls,<span class="dv">0</span>),<span class="st">"]"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Con un 95% de confianza podemos esperar que la verdadera media aritm√©tica de IQ de esta poblaci√≥n se encuentre entre [98, 118]"</code></pre>
</div>
</div>
</section>
<section id="ejercicios-4.1" class="slide level2">
<h2>Ejercicios 4.1</h2>
<p>La concentraci√≥n media de glucosa en ratones sanos se ha estimado en un rango entre 80 y 100 mg/dL. En un experimento, se han medido las siguientes concentraciones de glucosa en 10 ratones de una l√≠nea gen√©tica se presume tendr√≠a potencial de ser modelo de hiperglucemia despu√©s de unas cuantas m√°s generaciones de cruce selectivo:</p>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>glc_rat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">108.7</span>, <span class="fl">93.7</span>, <span class="fl">52.7</span>, <span class="fl">79.0</span>, <span class="fl">74.7</span>, <span class="fl">131.9</span>, <span class="fl">99.5</span>, <span class="fl">63.3</span>, <span class="fl">98.6</span>, <span class="fl">92.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ul>
<li><p>Calcula la media aritm√©tica <span class="math inline">\(\overline{X}\)</span>, la desviaci√≥n de est√°ndar <span class="math inline">\(s\)</span> y el intervalo de confianza al 95% de la concentraci√≥n de glucosa en estos ratones. Sin recurrir a pruebas estad√≠sticas formales, ¬ødir√≠as que sus niveles de glucosa est√°n dentro de lo normal o hay raz√≥n para desconfiar que son hipergluc√©micos?</p></li>
<li><p>Calcula el <span class="math inline">\(\text{IC}_{95}\)</span> sin usar la distribuci√≥n de Student y nota la diferencia.</p></li>
</ul>
</div>
</section></section>
<section>
<section id="pruebas-de-hip√≥tesis" class="title-slide slide level1 center">
<h1>Pruebas de hip√≥tesis</h1>

</section>
<section id="hip√≥tesis-de-investigaci√≥n-vs.-hip√≥tesis-estad√≠sticas" class="slide level2 smaller">
<h2>Hip√≥tesis de investigaci√≥n vs.&nbsp;hip√≥tesis estad√≠sticas</h2>
<div>
<ul>
<li class="fragment"><p>Una hip√≥tesis de investigaci√≥n gira alrededor del desarrollar una conclusi√≥n cient√≠fica acerca de un tema de inter√©s del investigador. Ejemplos: <em>el fumar causa c√°ncer</em>, <em>las vacunas causan/previenen enfermedades</em>.</p>
<ul>
<li class="fragment">Es decir, pueden tener una naturaleza subjetiva, que expresan la pregunta del investigador de una manera general sin mayor descripci√≥n del ¬øc√≥mo? voy a probar o descartarla, ni ¬øen qu√© extensi√≥n?.</li>
</ul></li>
<li class="fragment"><p>Hip√≥tesis estad√≠sticas, por el contrario, deben ser matem√°ticamente precisas y basadas en las caracter√≠sticas de los datos que recolectemos con el fin de probar o descartar la hip√≥tesis de investigaci√≥n.</p>
<ul>
<li class="fragment"><p>C√≥mo es de esperar, el probar o descartar una hip√≥tesis estad√≠stica ser√° √∫nicamente v√°lida para la poblaci√≥n sobre la cual una muestra fue tomada.</p></li>
<li class="fragment"><p>Es ah√≠ donde radica la importancia en definir la poblaci√≥n sujeto de estudio de manera planificada con el objetivo de que cumpla tantos detalles sean necesarios de la hip√≥tesis de investigaci√≥n. Ejemplo, el modelo animal m√°s usado es el rat√≥n. Si bien es cierto constituye uno de los primeros pasos en el desarrollo de muchas investigaciones, los hallazgos en ratones NO pueden ser inmediatamente atribuibles a suceder en seres humanos.</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="hip√≥tesis-nula-y-alternativa" class="slide level2 smaller">
<h2>Hip√≥tesis nula y alternativa</h2>
<div>
<ul>
<li class="fragment"><p>La formulaci√≥n de hip√≥tesis estad√≠sticas puede reducirse a establer preguntas de investigaci√≥n en forma de las hip√≥tesis nula y alternativa.</p></li>
<li class="fragment"><p>La m√°s sencilla manera de formular esta dupla, es la siguiente. Supongamos que tenemos dos grupos experimentales para probar la eficiencia de un nuevo procedimiento quir√∫rgico. Un grupo de pacientes ser√° sometido a la intervenci√≥n tradicional (control), y el otro grupo al nuevo procedimiento (experimental).</p>
<ul>
<li class="fragment"><p>La hip√≥tesis nula (<span class="math inline">\(H_0\)</span>) establece que: no existe diferencia entre el grupo control y el grupo experimental,</p></li>
<li class="fragment"><p>Mientras que la hip√≥tesis alternativa (<span class="math inline">\(H_a\)</span>) establece que: s√≠ existe differencia entre ambos.</p></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c = \mu_e&amp; H_0&amp; : \mu_c- \mu_e =0 \\
H_a&amp; : \mu_c \neq \mu_e&amp; H_a&amp; : \mu_c- \mu_e \neq 0
\end{align}\]</span>
</div>
</section>
<section id="tipos-de-errores" class="slide level2">
<h2>Tipos de errores</h2>
<div>
<ul>
<li class="fragment">Al llevar a cabo pruebas de hip√≥tesis pueden ocurrir errores</li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{array}{|c||c||c|}
  \hline
  &amp; \text{Acepta }H_{0} &amp; \text{Rechaza }H_{0} \\
  \hline
H_{0}\text{ es verdadera} &amp; \text{Desici√≥n correcta} &amp; \text{Error tipo I} \\
  H_{0}\text{ es falsa} &amp; \text{Error tipo II} &amp; \text{Desici√≥n correcta} \\
   \hline
\end{array}\]</span>
</div>
<div class="fragment">
<ul>
<li>¬øDe qu√© depende que aceptemos correctamente o no la hip√≥tesis nula?</li>
</ul>
</div>
<div class="fragment">
<p>Las pruebas estad√≠sticas dependen de la cantidad de variaci√≥n y la diferencia entre tratamientos a detectar (<strong>tama√±o del efecto</strong>). La soluci√≥n: aumentar el n√∫mero de observaciones</p>
</div>
</section>
<section id="poder-de-una-prueba-estad√≠stica" class="slide level2">
<h2>Poder de una prueba estad√≠stica</h2>
<div>
<ul>
<li class="fragment"><p>El poder de una prueba estad√≠stica es la probabilidad de rechazar la hip√≥tesis nula cuando esta es de hecho falsa.</p></li>
<li class="fragment"><p>Se puede derivar de la tabla anterior</p></li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{array}{|c||c||c|}
  \hline
  &amp; \text{Acepta }H_{0} &amp; \text{Rechaza }H_{0} \\
  \hline
H_{0}\text{ es verdadera} &amp; 1-\alpha\text{ (Prob. decisi√≥n correcta)} &amp; \alpha\text{ (Taza Error tipo I)} \\
  H_{0}\text{ es falsa} &amp; \beta\text{ (Taza Error tipo II)} &amp; 1-\beta\text{ (Poder)} \\
   \hline
\end{array}\]</span>
</div>
<div class="fragment">
<ul>
<li>En la pr√°ctica, existen f√≥rmulas cerradas para la determinaci√≥n del n√∫mero m√≠nimo de observaciones para alcanzar un poder adecuado (<span class="math inline">\(\ge\)</span> 80%).</li>
</ul>
</div>
</section>
<section id="tama√±o-del-efecto" class="slide level2 smaller">
<h2>Tama√±o del efecto</h2>
<div>
<ul>
<li class="fragment"><p>El tama√±o del efecto (<span class="math inline">\(\theta\)</span>) es un valor que por lo general es determinado por el investigador y que puede ser la diferencia de inter√©s a detectar en una prueba estad√≠stica.</p></li>
<li class="fragment"><p>Por simplicidad, vamos a enfocarnos en el ejercicio de los ratones. Supongamos que el investigador est√° interesado en saber cual ser√≠a el n√∫mero de ratones que necesitar√≠a para con un 80% de poder, encontrar una diferencia entre la media aritm√©tica de su muestra y un valor que considera razonable chequear igual a 100 mg/dL. Este √∫ltimo valor viene a ser el <span class="math inline">\(\theta\)</span>.</p></li>
<li class="fragment"><p>Las hip√≥tesis de esta prueba se ver√≠an as√≠</p></li>
</ul>
</div>
<div class="fragment">
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r = \theta \\
H_a&amp; : \mu_c- \mu_r \neq \theta
\end{align}\]</span>
<div>
<ul>
<li class="fragment"><p>Sin embargo, la pregunta del investigador a√∫n est√° incompleta. <span class="fragment"><strong>A tu criterio, ¬øqu√© falta?</strong></span></p></li>
<li class="fragment"><p>Al formular hip√≥tesis, hemos considerado el caso m√°s simple hasta el momento. Pero recordando la idea inicial del experimento de los ratones, la opci√≥n l√≥gica ser√≠a preguntarnos ¬øcu√°ntos ratones necesitamos para estar seguros que la poblaci√≥n sea hipergluc√©mica? (cuyo valor de glucosa en sangre est√© por encima del de un rat√≥n sano)</p></li>
</ul>
</div>
</div>
</section>
<section id="pruebas-de-dos-colas" class="slide level2">
<h2>Pruebas de dos colas</h2>
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r = \theta \\
H_a&amp; : \mu_c- \mu_r \neq \theta
\end{align}\]</span>

<img data-src="images/dcolas.gif" width="400" class="r-stretch quarto-figure-center"><p class="caption">Imagen tomada de <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/" target="_blank"><em>UCLA: Advanced Research Computing</em></a></p></section>
<section id="pruebas-de-una-cola" class="slide level2">
<h2>Pruebas de una cola</h2>
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r \le \theta \\
H_a&amp; : \mu_c- \mu_r &gt; \theta
\end{align}\]</span>

<img data-src="images/ucolagreat.gif" width="400" class="r-stretch quarto-figure-center"><p class="caption">Imagen tomada de <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/" target="_blank"><em>UCLA: Advanced Research Computing</em></a></p></section>
<section id="pruebas-de-una-cola-1" class="slide level2" data-visibility="uncounted">
<h2>Pruebas de una cola</h2>
<span class="math display">\[\begin{align}
H_0&amp; : \mu_c- \mu_r \ge \theta \\
H_a&amp; : \mu_c- \mu_r &lt; \theta
\end{align}\]</span>

<img data-src="images/ucolaless.gif" width="400" class="r-stretch quarto-figure-center"><p class="caption">Imagen tomada de <a href="https://stats.oarc.ucla.edu/other/mult-pkg/faq/general/faq-what-are-the-differences-between-one-tailed-and-two-tailed-tests/" target="_blank"><em>UCLA: Advanced Research Computing</em></a></p></section>
<section id="un-ejemplo-de-an√°lisis-de-poder" class="slide level2">
<h2>Un ejemplo de an√°lisis de poder</h2>
<div>
<ul>
<li class="fragment"><p>Retomando el poder de una prueba estad√≠stica (aunque no es un objetivo de este curso), culminaremos esta secci√≥n ejemplificando un an√°lisis de poder con nuestro ejemplo del IQ de una muestra de participantes de una determinada poblaci√≥n.</p></li>
<li class="fragment"><p>Sin entrar en mayor detalle, esto puede lograrse mediante el uso de la librer√≠a <code>pwr</code></p></li>
<li class="fragment"><p>El tama√±o del efecto para an√°lisis de poder tiene que ser estandarizado</p></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[
\theta = \frac{\hat{\mu}_r-\hat{\mu}_c}{s}
\]</span></p>
<div class="footer">
<p>Para mayor detalle del uso de <code>pwr</code> en an√°lisis de poder, puedes acceder a <a href="https://med.und.edu/research/daccota/_files/pdfs/berdc_resource_pdfs/sample_size_r_module.pdf" target="_blank">este recurso</a></p>
</div>
</div>
</section>
<section id="un-ejemplo-de-an√°lisis-de-poder-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Un ejemplo de an√°lisis de poder</h2>
<div>
<ul>
<li class="fragment">Acerca del IQ de la muestra de una poblaci√≥n, supongamos que el investigador est√° interesado en saber el n√∫mero de participantes necesarios para conducir un estudio donde se pueda demostrar que un valor de 100 en IQ esta dentro de la media aritm√©tica del IQ de la poblaci√≥n de donde se tom√≥ la muestra.</li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb13" data-code-line-numbers="3|4|5|6|8|10|11|12|13|14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>IQ_muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">98</span>, <span class="dv">116</span>, <span class="dv">96</span>, <span class="dv">129</span>)</span>
<span id="cb13-4"><a href="#cb13-4"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(IQ_muestra)</span>
<span id="cb13-5"><a href="#cb13-5"></a>uc <span class="ot">&lt;-</span> <span class="fu">mean</span>(IQ_muestra)</span>
<span id="cb13-6"><a href="#cb13-6"></a>ur <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a>theta <span class="ot">&lt;-</span> (ur<span class="sc">-</span>uc)<span class="sc">/</span>s</span>
<span id="cb13-9"><a href="#cb13-9"></a></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> theta, </span>
<span id="cb13-11"><a href="#cb13-11"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-12"><a href="#cb13-12"></a>           <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb13-13"><a href="#cb13-13"></a>           <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb13-14"><a href="#cb13-14"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="un-ejemplo-de-an√°lisis-de-poder-2" class="slide level2" data-visibility="uncounted">
<h2>Un ejemplo de an√°lisis de poder</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">library</span>(pwr)</span>
<span id="cb14-2"><a href="#cb14-2"></a></span>
<span id="cb14-3"><a href="#cb14-3"></a>IQ_muestra <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">101</span>, <span class="dv">98</span>, <span class="dv">116</span>, <span class="dv">96</span>, <span class="dv">129</span>)</span>
<span id="cb14-4"><a href="#cb14-4"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(IQ_muestra)</span>
<span id="cb14-5"><a href="#cb14-5"></a>uc <span class="ot">&lt;-</span> <span class="fu">mean</span>(IQ_muestra)</span>
<span id="cb14-6"><a href="#cb14-6"></a>ur <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb14-7"><a href="#cb14-7"></a></span>
<span id="cb14-8"><a href="#cb14-8"></a>theta <span class="ot">&lt;-</span> (ur<span class="sc">-</span>uc)<span class="sc">/</span>s</span>
<span id="cb14-9"><a href="#cb14-9"></a></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="fu">pwr.t.test</span>(<span class="at">d =</span> theta, </span>
<span id="cb14-11"><a href="#cb14-11"></a>           <span class="at">sig.level =</span> <span class="fl">0.05</span>,</span>
<span id="cb14-12"><a href="#cb14-12"></a>           <span class="at">power =</span> <span class="fl">0.80</span>,</span>
<span id="cb14-13"><a href="#cb14-13"></a>           <span class="at">type =</span> <span class="st">"one.sample"</span>,</span>
<span id="cb14-14"><a href="#cb14-14"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     One-sample t test power calculation 

              n = 26.45135
              d = 0.5663939
      sig.level = 0.05
          power = 0.8
    alternative = two.sided</code></pre>
</div>
</div>
</section>
<section id="ejercicio-4.2" class="slide level2">
<h2>Ejercicio 4.2</h2>
<p>A partir de los estad√≠sticos de muestreo de la muestra de ratones del ejemplo anterior, ¬øcu√°l ser√≠a el n√∫mero de los mismos para en un futuro experimento llevar a cabo una prueba estad√≠stica con al menos 80% de poder si el objetivo es demostrar que de hecho la media aritm√©tica de esta l√≠nea de ratones est√° por encima del l√≠mite superior de 100 mg/dL de glucosa en sangre que se sabe poseen ratones saludables?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>glc_rat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">108.7</span>, <span class="fl">93.7</span>, <span class="fl">52.7</span>, <span class="fl">79.0</span>, <span class="fl">74.7</span>, <span class="fl">131.9</span>, <span class="fl">99.5</span>, <span class="fl">63.3</span>, <span class="fl">98.6</span>, <span class="fl">92.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="valores-cr√≠ticos-y-el-valor-p" class="slide level2">
<h2>Valores cr√≠ticos y el valor p</h2>
<div>
<ul>
<li class="fragment"><p>Pero ¬øc√≥mo sabemos si una hip√≥tesis es aceptada o rechazada?</p></li>
<li class="fragment"><p>Regresando al concepto de los intervalos de confianza, los cuartiles de la distribuci√≥n de Student calculados a un nivel de significancia <span class="math inline">\(\alpha\)</span> son valores cr√≠ticos sobre los cuales se determina el rechazo o aceptaci√≥n de la hip√≥tesis nula.</p></li>
<li class="fragment"><p>El valor p, describe que tan probable ser√≠a observar resultados de la prueba asumiendo que la hip√≥tesis nula no hubiese sido rechazada. Por ello, a menores valores p, mayor la diferencia estad√≠stica con respecto a la hip√≥tesis alternativa.</p></li>
</ul>
</div>
</section>
<section id="antes-de-continuar" class="slide level2">
<h2>Antes de continuar</h2>

<img data-src="images/cena.png" class="r-stretch quarto-figure-center"><div class="footer">
<p>Imagen tomada de <a href="https://arbor-analytics.com/post/2022-10-10-p-ing-in-the-woods-p-values-in-forest-science/" target="_blank">aqu√≠</a></p>
</div>
</section>
<section id="antes-de-continuar-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment"><p>El umbral de 0.05 es una convenci√≥n arbitraria <a href="https://www.bmj.com/rapid-response/2011/11/03/origin-5-p-value-threshold#:~:text=statistician%20RA%20Fisher%20in%201926%20%5B1%5D." target="_blank">creada por Fischer</a> en los inicios de la estad√≠stica moderna.</p></li>
<li class="fragment"><p>Lastimosamente, se ha generalizado la idea de que por m√°s m√≠nima sea la diferencia con respecto a 0.05, esta representa la diferencia entre publicar o no (en el campo acad√©mico), entre lanzar o no un nuevo f√°rmaco/producto al mercado (en la industria).</p></li>
<li class="fragment"><p>En 2014, debido a un fallo de la <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5017929/#:~:text=A%20statistically%20significant%20test%20result,that%20no%20effect%20was%20observed." target="_blank">corte suprema de justicia de los Estados Unidos</a> que le dio la potestad a los inversionistas de farmace√∫ticas a demandarlas por fallar en reportar efectos secundarios de sus productos a pesar de haber sido hallados estad√≠sticamente no significativos, la Asociaci√≥n Americana de Estad√≠stica (ASA) se vio en la necesidad de definir m√°s exhaustivamente el concepto del valor p.</p></li>
<li class="fragment"><p>Entre las recomendaciones de la ASA, se enfatiz√≥ el dar mayor prioridad a la estimaci√≥n de otros estad√≠sticos complementarios al valor p, tales como intervalos de confianza u otros provenientes de la estad√≠stica Bayesiana (intervalos de credibilidad, factores de Bayes).</p></li>
<li class="fragment"><p>Esta √∫ltima (estad√≠stica Bayesiana), ofrece una interpretaci√≥n m√°s natural de la estad√≠stica al basarse en m√©tricas de incertidumbre puras y no en n√∫meros arbirtrarios como el valor p.</p></li>
<li class="fragment"><p>En resumen, una investigaci√≥n no es in√∫til si el valor p sobrepasa o est√° por debajo de 0.05 por cantidades peque√±as.</p></li>
</ul>
</div>
</section>
<section id="antes-de-continuar-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment"><p>En su lugar, en escenarios en que el valor p est√° alejado por una d√©cima o varias cent√©simas de 0.05, los resultados deber√≠an interpretarse como indeterminados para generalizar sobre la poblaci√≥n objeto de estudio y espec√≠ficos a las condiciones experimentales (an√°lisis estad√≠sticos, instrumentos de medici√≥n, etc) bajo las cuales fueron tomadas y modeladas las mediciones.</p></li>
<li class="fragment"><p>En el contexto de los modelos estad√≠sticos que veremos m√°s adelante, esto ha derivado en un ‚Äútemor‚Äù del investigador cuando los resultados no pasan los chequeos de los supuestos sobre los que estos modelos se cimentan. Sobre todo cuando el valor p dista de 0.05 por √≠nfimas cantidades.</p></li>
<li class="fragment"><p>Esto puede llevar a malas pr√°cticas cient√≠ficas tales como: no reportar el resultado de los chequeos, blindar los datos, escoger ‚Äúoutliers‚Äù y removerlos y en el peor de los casos, manipular los datos para tratar de acomodar nuestros datos a estos chequeos.</p></li>
<li class="fragment"><p>Todo lo que he mencionado, no solamente constituyen casos de mala conducta cient√≠fica, sino lo que hoy en d√≠a se le conoce como <em>p hacking</em> (que se puede resumir a torturar los datos hasta que nos confiesen una verdad agradable a nuestros prop√≥sitos).</p></li>
</ul>
</div>
</section></section>
<section>
<section id="pruebas-estad√≠sticas-param√©tricas" class="title-slide slide level1 center">
<h1>Pruebas estad√≠sticas param√©tricas</h1>

</section>
<section id="datos-para-esta-secci√≥n" class="slide level2">
<h2>Datos para esta secci√≥n</h2>
<div>
<ul>
<li class="fragment"><p>Para esta secci√≥n del curso usaremos algunas de las tablas de datos del libro <a href="https://www.routledge.com/Using-R-for-Introductory-Statistics/Verzani/p/book/9781466590731#:~:text=Resources%20Support%20Material-,Book%20Description,small%2C%20task%2Doriented%20steps." target="_blank"><em>Using R for Introductory Statistics</em></a>, como tambi√©n de la librer√≠a <code>datarium</code>.</p></li>
<li class="fragment"><p>Para ello, instalaremos las librer√≠as de R: <code>UsingR</code> y <code>datarium</code>.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">library</span>(UsingR)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="fu">library</span>(datarium)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="pruebas-t" class="slide level2 smaller">
<h2>Pruebas t</h2>
<div>
<ul>
<li class="fragment"><p>Las pruebas t son usadas para encontrar la diferencia entre dos medias aritm√©ticas.</p></li>
<li class="fragment"><p>La <span class="math inline">\(H_0\)</span> en estas pruebas es que las medias aritm√©ticas son las mismas.</p></li>
<li class="fragment"><p>Se rechaza la <span class="math inline">\(H_0\)</span> cuando el valor p resultante es <span class="math inline">\(&lt;\)</span> 0.05</p></li>
<li class="fragment"><p>Existen tres tipos de pruebas t</p>
<ul>
<li class="fragment"><p>Pruebas t de una muestra</p></li>
<li class="fragment"><p>Pruebas t de muestras independientes</p></li>
<li class="fragment"><p>Pruebas t de muestras emparejadas</p></li>
</ul></li>
<li class="fragment"><p>Estas pruebas fueron desarrolladas bajo la suposici√≥n de la <strong>normalidad</strong> y de <strong>homogeneidad de las varianzas</strong>.</p></li>
<li class="fragment"><p>De acuerdo a lo que hemos visto acerca del teorema del l√≠mite central, muestras grandes casi aseguran la normalidad.</p></li>
<li class="fragment"><p>Cuando el n√∫mero de observaciones en una muestra es peque√±o, es recomendable llevar a cabo un test de normalidad para decidir si es posible llevar a cabo una prueba t o una de sus alternativas.</p></li>
</ul>
</div>
</section>
<section id="normalidad-de-una-muestra" class="slide level2">
<h2>Normalidad de una muestra</h2>
<div>
<ul>
<li class="fragment"><p>Antes de llevar a cabo las pruebas t, hemos mencionado sus supuestos. Por ello, es aconsejable el siempre realizar estas pruebas antes de usarlas.</p></li>
<li class="fragment"><p>Existen dos tipos de pruebas para establecer si una muestra es normalmente distribuida o no</p>
<ul>
<li class="fragment"><p>Indirectamente: gr√°fico Q-Q</p></li>
<li class="fragment"><p>Prueba formal de normalidad (ejemplo: Shapiro-Wilk)</p></li>
</ul></li>
<li class="fragment"><p><strong>En el caso del ANOVA</strong>, es importante enfatizar que estas pruebas no necesariamente tienen que hacerse antes de la prueba, como ya veremos m√°s adelante.</p></li>
</ul>
</div>
</section>
<section id="gr√°fico-q-q" class="slide level2">
<h2>Gr√°fico Q-Q</h2>
<div>
<ul>
<li class="fragment"><p>El gr√°fico Q-Q es una prueba visual indirecta de la normalidad.</p></li>
<li class="fragment"><p>Consiste en crear un gr√°fico de dispersi√≥n entre los valores observados de una muestra vs.&nbsp;los valores que deber√≠an estos tener si siguieran una distribuci√≥n normal.</p></li>
<li class="fragment"><p>Mientras en el gr√°fico de dispersi√≥n los puntos m√°s se distribuyan a lo largo de una diagonal, m√°s cercanos est√°n los datos de la muestra a seguir un distribuci√≥n normal.</p></li>
<li class="fragment"><p>Su desventaja es que es muy subjetivo, y a menudo requiere una prueba formal para poder confirmarlo.</p></li>
</ul>
</div>
</section>
<section id="gr√°fico-q-q-1" class="slide level2" data-visibility="uncounted">
<h2>Gr√°fico Q-Q</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># simulamos 30 observaciones de una normal estandar</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">qqnorm</span>(y)                             <span class="co"># producimos el gr√°fico Q-Q</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="gr√°fico-q-q-2" class="slide level2" data-visibility="uncounted">
<h2>Gr√°fico Q-Q</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)  <span class="co"># simulamos 30 observaciones de una normal estandar</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="fu">qqnorm</span>(y)                             <span class="co"># producimos el gr√°fico Q-Q</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-14-1.png" width="576" class="r-stretch quarto-figure-center"></section>
<section id="prueba-de-normalidad-shapiro-wilk" class="slide level2">
<h2>Prueba de normalidad Shapiro-Wilk</h2>
<div>
<ul>
<li class="fragment"><p>La <span class="math inline">\(H_0\)</span> de esta prueba (y del resto de pruebas formales de normalidad) es que un set de <span class="math inline">\(n\)</span> observaciones es normalmente distribuido.</p></li>
<li class="fragment"><p>Otro conocido m√©todo es Kolmogorov-Smirnov. Sin embargo, Shapiro-Wilk es m√°s apropiado para cuando el n√∫mero de muestras es menor a 50.</p></li>
<li class="fragment"><p>Para ilustrar su uso, chequeemos la normalidad de los datos que simulamos anteriormente</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="fu">shapiro.test</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  y
W = 0.97894, p-value = 0.7966</code></pre>
</div>
</div>
</div>
</section>
<section id="prueba-de-homogeneidad-de-las-varianzas" class="slide level2 smaller">
<h2>Prueba de homogeneidad de las varianzas</h2>
<div>
<ul>
<li class="fragment"><p>En el caso de comparaciones entre las medias de dos grupos, la homogeneidad de varianzas puede chequearse usando la prueba F.</p></li>
<li class="fragment"><p>La prueba t de una muestra no requiere chequear este supuesto.</p></li>
<li class="fragment"><p>Para ilustrar su uso, creemos otro vector con datos simulados. En este caso, un igual n√∫mero de observaciones con la misma desviaci√≥n est√°ndar pero diferente media:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="fu">var.test</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  x and y
F = 1, num df = 29, denom df = 29, p-value = 1
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.4759648 2.1009958
sample estimates:
ratio of variances 
                 1 </code></pre>
</div>
</div>
</div>
</section>
<section id="supuestos-en-la-pr√°ctica" class="slide level2 scrollable">
<h2>Supuestos en la pr√°ctica</h2>
<div>
<ul>
<li class="fragment"><p>Usemos las pruebas con datos reales, esta vez con la tabla de datos <code>crime</code> de la librer√≠a <code>Using R</code>.</p></li>
<li class="fragment"><p>Esta tabla de datos contiene registros de las tasas de crimen (# de reportes/100000 habitantes) en 50 estados en los Estados Unidos correspondiente a los a√±os 1983 y 1993.</p></li>
<li class="fragment"><p>Sin enfocarnos por el momento en que prueba t espec√≠fica usaremos, limit√©monos a chequear la normalidad y la homogeneidad de varianzas entre las tasas de crimen registradas en 1983 y 1993.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="fu">data</span>(crime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Normalidad 1983</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">shapiro.test</span>(crime<span class="sc">$</span>y1983)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  crime$y1983
W = 0.77333, p-value = 1.827e-07</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Normalidad 1993</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">shapiro.test</span>(crime<span class="sc">$</span>y1993)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  crime$y1993
W = 0.77348, p-value = 1.841e-07</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Homogeneidad de las varianzas</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">var.test</span>(crime<span class="sc">$</span>y1983, crime<span class="sc">$</span>y1993)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  crime$y1983 and crime$y1993
F = 0.49163, num df = 50, denom df = 50, p-value = 0.01342
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.2806163 0.8613069
sample estimates:
ratio of variances 
         0.4916266 </code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/calmarno.jpg"></p>
</figure>
</div>
</div>
</section>
<section id="transformaci√≥n-de-variables" class="slide level2">
<h2>Transformaci√≥n de variables</h2>
<div>
<ul>
<li class="fragment"><p>A menudo nos encontraremos con conjuntos de observaciones que no cumplen uno o ninguno de los supuestos.</p></li>
<li class="fragment"><p>Antes de considerar pruebas no param√©tricas, podemos intentar transformaciones de variables para regresar al mundo de las pruebas param√©tricas. Las transformaciones m√°s usadas son:</p>
<ul>
<li class="fragment"><p>La ra√≠z cuadrada (si los datos no contienen n√∫meros negativos)</p></li>
<li class="fragment"><p>Elevar al cuadrado</p></li>
<li class="fragment"><p>Logaritmo (si los datos solo incluyen n√∫meros reales positivos, cero excluido)</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="transformaci√≥n-de-variables-1" class="slide level2" data-visibility="&quot;uncounted">
<h2>Transformaci√≥n de variables</h2>
<div>
<ul>
<li class="fragment"><p>Existe un m√©todo m√°s sofisticado para ‚Äúnormalizar‚Äù una muestra. <span class="fragment"><a href="https://www.r-bloggers.com/2022/10/box-cox-transformation-in-r/">La transformaci√≥n de Box-Cox.</a></span></p></li>
<li class="fragment"><p>Cuando se trabaja con muestras transformadas, el objetivo es poder revertir la transformaci√≥n a las unidades reales para as√≠ poder hacer conclusiones sobre las inferencias estad√≠sticas.</p></li>
<li class="fragment"><p>En otras palabras, una misma transformaci√≥n <strong>debe</strong> aplicarse a todos los grupos a ser comparados. <strong>NO</strong> tiene ning√∫n sentido tratar de realizar inferencias entre grupos donde se hayan usado distintas transformaciones para normalizarlos.</p></li>
<li class="fragment"><p>Si el n√∫mero de observaciones es muy reducido, usualmente no hay transformaci√≥n que funcione y se recomienda usar directamente pruebas no param√©tricas.</p></li>
</ul>
</div>
</section>
<section id="transformaci√≥n-de-variables-2" class="slide level2 scrollable" data-visibility="&quot;uncounted">
<h2>Transformaci√≥n de variables</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Ra√≠z cuadrada</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">shapiro.test</span>(<span class="fu">sqrt</span>(crime<span class="sc">$</span>y1983))     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  sqrt(crime$y1983)
W = 0.9411, p-value = 0.01359</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Elevar al cuadrado</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">shapiro.test</span>(crime<span class="sc">$</span>y1983<span class="sc">^</span><span class="dv">2</span>)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  crime$y1983^2
W = 0.38921, p-value = 2.954e-13</code></pre>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Logaritmo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">shapiro.test</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983))     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  log(crime$y1983)
W = 0.98076, p-value = 0.5713</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Chequeemos con el otro grupo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">shapiro.test</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1993))     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  log(crime$y1993)
W = 0.96191, p-value = 0.1006</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Homogeneidad de las varianzas con transformaci√≥n logar√≠tmica</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">var.test</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983), <span class="fu">log</span>(crime<span class="sc">$</span>y1993))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  log(crime$y1983) and log(crime$y1993)
F = 0.84048, num df = 50, denom df = 50, p-value = 0.5412
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.4797393 1.4724831
sample estimates:
ratio of variances 
         0.8404808 </code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/kid.jpg"></p>
</figure>
</div>
</div>
</section>
<section id="prueba-t-de-una-muestra" class="slide level2">
<h2>Prueba t de una muestra</h2>
<div>
<ul>
<li class="fragment"><p>Es usada para comparar la media aritm√©tica de una muestra con un valor conocido (un est√°ndar por ejemplo).</p></li>
<li class="fragment"><p>Por lo general la el valor al que se va a comparar proviene de referencias bibliogr√°ficas, pre-experimentos o supociones fundamentadas.</p></li>
<li class="fragment"><p>En este caso, el supuesto que debe cumplirse es el de la normalidad de los datos</p></li>
<li class="fragment"><p>Regresando a nuestro ejemplo de los ratones, determinemos si la media de la muestra es mayor al l√≠mite superior de glucosa de ratones saludables.</p></li>
</ul>
</div>
</section>
<section id="prueba-t-de-una-muestra-1" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t de una muestra</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb41" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>glc_rat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">108.7</span>, <span class="fl">93.7</span>, <span class="fl">52.7</span>, <span class="fl">79.0</span>, <span class="fl">74.7</span>, <span class="fl">131.9</span>, <span class="fl">99.5</span>, <span class="fl">63.3</span>, <span class="fl">98.6</span>, <span class="fl">92.7</span>)</span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="fu">t.test</span>(glc_rat,</span>
<span id="cb41-3"><a href="#cb41-3"></a>       <span class="at">mu =</span> <span class="dv">100</span>,</span>
<span id="cb41-4"><a href="#cb41-4"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prueba-t-de-una-muestra-2" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t de una muestra</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>glc_rat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">108.7</span>, <span class="fl">93.7</span>, <span class="fl">52.7</span>, <span class="fl">79.0</span>, <span class="fl">74.7</span>, <span class="fl">131.9</span>, <span class="fl">99.5</span>, <span class="fl">63.3</span>, <span class="fl">98.6</span>, <span class="fl">92.7</span>)</span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="fu">t.test</span>(glc_rat,</span>
<span id="cb42-3"><a href="#cb42-3"></a>       <span class="at">mu =</span> <span class="dv">100</span>,</span>
<span id="cb42-4"><a href="#cb42-4"></a>       <span class="at">alternative =</span> <span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  glc_rat
t = -1.4485, df = 9, p-value = 0.9093
alternative hypothesis: true mean is greater than 100
95 percent confidence interval:
 76.16687      Inf
sample estimates:
mean of x 
    89.48 </code></pre>
</div>
</div>
</section>
<section id="ejercicio-4.3" class="slide level2 smaller">
<h2>Ejercicio 4.3</h2>
<p>La tabla de datos <code>blood</code> de la librer√≠a <code>UsingR</code> tiene las medidas de presi√≥n sist√≥lica de sangre correspondientes a 15 pacientes (columna ‚Äúmachine‚Äù). De acuerdo al Centro de Prevenci√≥n y Control de Enfermedades de los Estados Unidos (CDC), una presi√≥n sist√≥lica saludable est√° por debajo de 120 mm Hg. Determina si la media de la muestra contenida en esta tabla de datos est√° por debajo de este valor sugerido por el CDC.</p>
<p>Copia y pega las siguientes l√≠neas de c√≥digo a tu script. Luego de ejecutarlas, una tabla de datos de nombre <code>blood</code> aparecer√° disponible en la ventana del ambiente de RStudio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="fu">data</span>(blood)</span>
<span id="cb44-2"><a href="#cb44-2"></a>blood</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Tip: para acceder a la columna con las presiones sist√≥licas, usa la siguiente sintaxis: <code>blood$machine</code></strong></p>
</section>
<section id="prueba-t-de-muestras-independientes" class="slide level2">
<h2>Prueba t de muestras independientes</h2>
<div>
<ul>
<li class="fragment"><p>Es usado para comparar las medias aritm√©ticas de dos grupos independientes.</p></li>
<li class="fragment"><p>Por ejemplo, si deseas comparar las medias aritm√©ticas de individuos agrupados por sexo.</p></li>
<li class="fragment"><p>Para ilustrar esta prueba, vamos a hacer uso de la tabla de datos de <code>genderweight</code> de la librer√≠a <code>datarium</code>.</p>
<ul>
<li class="fragment">Veamos si existe una diferencia significativa en la media del peso entre hombres y mujeres</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">data</span>(genderweight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prueba-t-de-muestras-independientes-1" class="slide level2 scrollable smaller" data-visibility="uncounted">
<h2>Prueba t de muestras independientes</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Chequeamos normalidad: Group M</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="fu">shapiro.test</span>(<span class="fu">subset</span>(genderweight, group <span class="sc">==</span> <span class="st">"M"</span>)<span class="sc">$</span>weight)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  subset(genderweight, group == "M")$weight
W = 0.98634, p-value = 0.9886</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Chequeamos normalidad: Group F</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">shapiro.test</span>(<span class="fu">subset</span>(genderweight, group <span class="sc">==</span> <span class="st">"F"</span>)<span class="sc">$</span>weight)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  subset(genderweight, group == "F")$weight
W = 0.93847, p-value = 0.2243</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<p>Chequeamos la homogeneidad de las varianzas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="fu">var.test</span>(genderweight<span class="sc">$</span>weight <span class="sc">~</span> genderweight<span class="sc">$</span>group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  genderweight$weight by genderweight$group
F = 0.21692, num df = 19, denom df = 19, p-value = 0.001648
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.08585766 0.54802553
sample estimates:
ratio of variances 
         0.2169152 </code></pre>
</div>
</div>
<div>
<ul>
<li class="fragment"><p><strong>¬°La homogeneidad de las varianzas no se cumple!</strong> üò±</p></li>
<li class="fragment"><p>¬øDebemos transformar? <span class="fragment">No necesariamente</span></p></li>
<li class="fragment"><p><strong>√önicamente en el caso de las pruebas t</strong>, el no cumplir con el supuesto de la homogeneidad de varianzas no es un gran problema.</p></li>
<li class="fragment"><p>La funci√≥n base de R <code>t.test</code> cuenta con el argumento <code>var.equal = F</code> como default.</p></li>
<li class="fragment"><p>Bajo este argumento, no se asumen varianzas iguales entre los grupos y en su lugar R lleva a cabo la aproximaci√≥n de Welch para lidiar con este problema.</p></li>
</ul>
</div>
</div>
</section>
<section id="prueba-t-de-muestras-independientes-2" class="slide level2" data-visibility="uncounted">
<h2>Prueba t de muestras independientes</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="fu">t.test</span>(genderweight<span class="sc">$</span>weight <span class="sc">~</span> genderweight<span class="sc">$</span>group)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  genderweight$weight by genderweight$group
t = -20.791, df = 26.872, p-value &lt; 2.2e-16
alternative hypothesis: true difference in means between group F and group M is not equal to 0
95 percent confidence interval:
 -24.53135 -20.12353
sample estimates:
mean in group F mean in group M 
       63.49867        85.82612 </code></pre>
</div>
</div>
</section>
<section id="ejercicio-4.4" class="slide level2 smaller">
<h2>Ejercicio 4.4</h2>
<p>La tabla de datos <code>normtemp</code> de la librer√≠a <code>UsingR</code> tiene las medidas en grados Fahrenheit de temperatura corporal (columna ‚Äútemperature‚Äù ) correspodientes a 65 mujeres y 65 hombres (columna ‚Äúgender‚Äù). Determina si existe una diferencia entre las temperaturas corporales de hombres y mujeres.</p>
<p>Copia y pega las siguientes l√≠neas de c√≥digo a tu script. Luego de ejecutarlas, una tabla de datos de nombre <code>normtemp</code> aparecer√° disponible en la ventana del ambiente de RStudio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="fu">data</span>(normtemp)</span>
<span id="cb54-2"><a href="#cb54-2"></a>normtemp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Tip: para acceder a las columnas con las temperaturas corporales y sexo, usa la siguiente sintaxis: <code>normtemp$temperature</code> y <code>normtemp$gender</code> respectivamente</strong></p>
</section>
<section id="prueba-t-para-muestras-emparejadas" class="slide level2">
<h2>Prueba t para muestras emparejadas</h2>
<div>
<ul>
<li class="fragment"><p>Es usado para comparar las medias de dos grupos que guardan una relaci√≥n.</p></li>
<li class="fragment"><p>Esto solo ocurre cuando las medidas se han realizado a partir de los mismos grupos. Por ejemplo, al inicio y al final de un experimento.</p></li>
<li class="fragment"><p>Para esta prueba, vamos a usar la tabla de datos <code>crime</code> de la librer√≠a <code>UsingR</code></p>
<ul>
<li class="fragment">Veamos si existe una diferencia en las tasas de crimen (# de reportes/100000 habitantes) en 50 estados de los Estados unidos entre 1983 y 1993</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">data</span>(crime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="prueba-t-para-muestras-emparejadas-1" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t para muestras emparejadas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1983), <span class="at">y =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1993), <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-2"><a href="#cb56-2"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983)))</span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1993)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prueba-t-para-muestras-emparejadas-2" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Prueba t para muestras emparejadas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">t.test</span>(<span class="at">x =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1983), <span class="at">y =</span> <span class="fu">log</span>(crime<span class="sc">$</span>y1993), <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  log(crime$y1983) and log(crime$y1993)
t = -10.027, df = 50, p-value = 1.469e-13
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.3628437 -0.2417349
sample estimates:
mean difference 
     -0.3022893 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1983)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 362.8298</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">exp</span>(<span class="fu">mean</span>(<span class="fu">log</span>(crime<span class="sc">$</span>y1993)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 490.8915</code></pre>
</div>
</div>
</section>
<section id="ejercicio-4.5" class="slide level2">
<h2>Ejercicio 4.5</h2>
<p>La tabla de datos <code>mice2</code> de la librer√≠a <code>datarium</code> tiene las medidas del peso de 10 ratones antes y despu√©s de haber sido sometidos a una determinada dieta. Encuentra si existe una diferencia significativa en el peso de estos ratones antes y despu√©s del r√©gimen de dieta al que fueron expuestos. ¬øGanaron o perdieron peso?</p>
<p>Copia y pega las siguientes l√≠neas de c√≥digo a tu script. Luego de ejecutarlas, una tabla de datos de nombre <code>mice2</code> aparecer√° disponible en la ventana del ambiente de RStudio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="fu">data</span>(mice2)</span>
<span id="cb63-2"><a href="#cb63-2"></a>mice2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Tip: usa el mismo tips de los ejemplos anteriores</strong></p>
</section>
<section id="ejercicios-4.6" class="slide level2 smaller">
<h2>Ejercicios 4.6</h2>
<ul>
<li>En la librer√≠a <code>UsingR</code> tenemos disponible una lista con 5 objetos bajo el nombre <code>cancer</code>. Esta contiene el tiempo de sobreviviencia en d√≠as de pacientes con distintos tipos de c√°ncer desde el momento de su diagn√≥stico hasta su deceso. Chequea si los datos correspondientes a cancer de colon son normalmente distribuidos. Si no lo son, prueba si puedes normalizarlos usando alguna de las tres transformaciones que vimos. En el caso que m√°s de una transformaci√≥n funcione, ¬øcu√°l escoger√≠as para continuar con alguna prueba estad√≠stica, y por qu√©?</li>
</ul>
<p><strong>Tip: usa el siguiente c√≥digo para extraer en un vector los datos de pacientes con c√°ncer de colon:</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="fu">data</span>(cancer)</span>
<span id="cb64-2"><a href="#cb64-2"></a>colon <span class="ot">&lt;-</span> cancer<span class="sc">$</span>colon</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="pruebas-estad√≠sticas-no-param√©tricas" class="title-slide slide level1 center">
<h1>Pruebas estad√≠sticas no param√©tricas</h1>

</section>
<section id="pruebas-de-wilcoxon-para-datos-no-normales" class="slide level2">
<h2>Pruebas de Wilcoxon para datos no normales</h2>
<div>
<ul>
<li class="fragment"><p>Las pruebas de Wilcoxon usan la mediana como criterio para evaluar la <span class="math inline">\(H_0\)</span>.</p></li>
<li class="fragment"><p>Lastimosamente, estas pruebas son usualmente menos poderosas (mayor tasa de errores tipo II).</p></li>
<li class="fragment"><p>Tiene dos formas:</p>
<ul>
<li class="fragment"><p>Pruebas para una muestra (an√°loga a la prueba t para una muestra)</p></li>
<li class="fragment"><p>Pruebas para dos muestras (an√°loga a las pruebas t para dos muestras independientes y emparejadas)</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="prueba-de-wilcoxon-para-una-muestra" class="slide level2">
<h2>Prueba de Wilcoxon para una muestra</h2>
<div>
<ul>
<li class="fragment"><p><a href="https://learningstatisticswithr.com/" target="_blank">Prof.&nbsp;Danielle Navarro</a> midi√≥ el nivel de felicidad de sus estudiantes antes y despu√©s de su clase de Estad√≠stica. Ella estaba interesada en saber si el tomar una clase de Estad√≠stica tiene alg√∫n efecto en la felicidad de sus estudiantes. Los datos que obtuvo no est√°n normalmente distribuidos. Por ello, se vio en la necesidad de llevar a cabo una prueba de Wilcoxon.</p></li>
<li class="fragment"><p>En este caso, la <span class="math inline">\(H_0\)</span>, es que la diferencia de la mediana de la felicidad de sus estudiantes antes y despu√©s de la clase deber√≠a ser igual a cero para clamar que no existe tal efecto.</p></li>
</ul>
</div>
</section>
<section id="prueba-de-wilcoxon-para-una-muestra-1" class="slide level2" data-visibility="uncounted">
<h2>Prueba de Wilcoxon para una muestra</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># Primero recreo la tabla de Prof. Navarro</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>felicidad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">before =</span> <span class="fu">c</span>(<span class="dv">30</span>,<span class="dv">43</span>,<span class="dv">21</span>,<span class="dv">24</span>,<span class="dv">23</span>,<span class="dv">40</span>,<span class="dv">29</span>,<span class="dv">56</span>,<span class="dv">38</span>,<span class="dv">16</span>),</span>
<span id="cb65-3"><a href="#cb65-3"></a>                        <span class="at">after =</span> <span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">11</span>,<span class="dv">31</span>,<span class="dv">17</span>,<span class="dv">2</span>,<span class="dv">31</span>,<span class="dv">21</span>,<span class="dv">8</span>,<span class="dv">21</span>))</span>
<span id="cb65-4"><a href="#cb65-4"></a>felicidad<span class="sc">$</span>change <span class="ot">&lt;-</span> felicidad<span class="sc">$</span>after <span class="sc">-</span> felicidad<span class="sc">$</span>before</span>
<span id="cb65-5"><a href="#cb65-5"></a></span>
<span id="cb65-6"><a href="#cb65-6"></a><span class="fu">wilcox.test</span>(felicidad<span class="sc">$</span>change, <span class="at">mu =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon signed rank exact test

data:  felicidad$change
V = 7, p-value = 0.03711
alternative hypothesis: true location is not equal to 0</code></pre>
</div>
</div>
</section>
<section id="prueba-de-wilcoxon-para-dos-muestras" class="slide level2">
<h2>Prueba de Wilcoxon para dos muestras</h2>
<div>
<ul>
<li class="fragment"><p>Regresando al ejemplo de la tabla de datos <code>genderweight</code>, supongamos que estos no est√°n normalmente distribuidos.</p></li>
<li class="fragment"><p>Usaremos la prueba de Wilcoxon para muestras independientes para ver si existe diferencia entre los pesos de hombres y mujeres.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="fu">wilcox.test</span>(genderweight<span class="sc">$</span>weight <span class="sc">~</span> genderweight<span class="sc">$</span>group, <span class="at">paired =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  genderweight$weight by genderweight$group
W = 0, p-value = 1.451e-11
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
</div>
</section>
<section id="ejercicios-4.7" class="slide level2">
<h2>Ejercicios 4.7</h2>
<ul>
<li><p>Con el vector de nombre <code>colon</code> que creaste en el ejercicio 4.6, aplica una prueba de Wilcoxon para una muestra bajo la hip√≥tesis de que la mediana de los d√≠as de superviviencia de un paciente con c√°ncer de colon es de 370 d√≠as.</p></li>
<li><p>A partir de la tabla de datos de felicidad de la Prof.&nbsp;Navarro, lleva a cabo una prueba de Wilcoxon para dos muestras emparejadas de la felicidad de los estudiantes antes y despu√©s de recibir una clase de Estad√≠stica. Compara el resultado con la prueba de una muestra que us√© de ejemplo. ¬øPor qu√© no hay diferencia?.</p></li>
</ul>
</section></section>
<section>
<section id="pruebas-b√°sicas-para-datos-discretos" class="title-slide slide level1 center">
<h1>Pruebas b√°sicas para datos discretos</h1>

</section>
<section id="tablas-de-contingencia" class="slide level2">
<h2>Tablas de contingencia</h2>
<div>
<ul>
<li class="fragment"><p>Una tabla de contigencia nos sirve para ver si los valores de una variable categ√≥rica dependen de los valores de otra variable categ√≥rica.</p></li>
<li class="fragment"><p>El an√°lisis de contingencia nos permite probar formalmente la asociaci√≥n entre dos o m√°s variables categ√≥ricas.</p>
<ul>
<li class="fragment"><p>¬øQu√© tan probable es que beban m√°s alcohol personas que fuman con respecto a aquellas que no?</p></li>
<li class="fragment"><p>¬øLas personas que toman una aspirina diaria tienen menos probabilidad de sufrir un ataque card√≠aco con respecto a las que no?</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="tabla-de-contingencia-n-times-n" class="slide level2">
<h2>Tabla de contingencia <span class="math inline">\(n \times n\)</span></h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/cont1.png" width="649" height="260"></p>
</figure>
</div>
<div class="footer">
<p><a href="https://www.mdpi.com/1660-4601/16/1/141" target="_blank">Modificado de Milo≈° Gejdo≈°, <em>et al.</em> (2019) <em>Int. J. Environ. Res. Public Health</em> <strong>16</strong>(1)</a></p>
</div>
</section>
<section id="tabla-de-contingencia-n-times-n-1" class="slide level2" data-visibility="uncounted">
<h2>Tabla de contingencia <span class="math inline">\(n \times n\)</span></h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/cont2.png" width="649" height="260"></p>
</figure>
</div>
<div>
<ul>
<li class="fragment"><p>La variable B (o respuesta) contendr√° como posibles resultados ‚Äú√©xito‚Äù o ‚Äúfracaso‚Äù.</p></li>
<li class="fragment"><p>La variable A (o explanatoria) posee las clases que identifican los grupos cuya probabilidad es sujeto de comparaci√≥n.</p></li>
</ul>
</div>
<div class="footer">
<p><a href="https://www.mdpi.com/1660-4601/16/1/141" target="_blank">Modificado de Milo≈° Gejdo≈°, <em>et al.</em> (2019) <em>Int. J. Environ. Res. Public Health</em> <strong>16</strong>(1)</a></p>
</div>
</section>
<section id="cociente-de-probabilidad-para-tablas-de-contingencia-2-times-2" class="slide level2">
<h2>Cociente de probabilidad para tablas de contingencia <span class="math inline">\(2 \times 2\)</span></h2>
<div>
<ul>
<li class="fragment"><p>El cociente de probabilidad mide la magnitud de asociaci√≥n entre dos variables categ√≥ricas cuando estas tienen dos clases.</p></li>
<li class="fragment"><p>En una tabla de contingencia <span class="math inline">\(2 \times 2\)</span>, el cociente de probabilidad (OR) se define como:</p></li>
</ul>
</div>
<div class="fragment">
<p><span class="math display">\[ OR=\frac{n_{11}/n_{12}}{n_{21}/n_{22}} \]</span></p>
</div>
</section>
<section id="cociente-de-probabilidad-para-tablas-de-contingencia-2-times-2-1" class="slide level2" data-visibility="uncounted">
<h2>Cociente de probabilidad para tablas de contingencia <span class="math inline">\(2 \times 2\)</span></h2>
<div>
<ul>
<li class="fragment"><p>La interpretaci√≥n del OR depende de la magnitud del mismo:</p>
<ul>
<li class="fragment"><p>Igual a 1, los eventos (clase de la variable explanatoria) son independientes de la variable de respuesta.</p></li>
<li class="fragment"><p>Mayor o menor a 1, existe una relaci√≥n positiva o negativa de la variable explanatoria con la variable de respuesta.</p></li>
<li class="fragment"><p>La magnitud de OR depende de la clase tomada como base en el an√°lisis.</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="cociente-de-probabilidad-en-r" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Cociente de probabilidad en R</h2>
<div class="fragment">
<p>Usaremos para este ejemplo los datos del Titanic. La pregunta de investigaci√≥n es: ¬øtuvieron las mujeres mayores probabilidades de salvarse durante el hundimiento del Titanic?</p>
</div>
<div class="fragment">
<ol type="1">
<li>Cargamos en nuestro ambiente la tabla de datos (librer√≠a <code>datarium</code>)</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="fu">data</span>(titanic.raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<ol start="2" type="1">
<li>Definimos las clases de referencia</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a>titanic.raw<span class="sc">$</span>Survived <span class="ot">&lt;-</span> <span class="fu">relevel</span>(titanic.raw<span class="sc">$</span>Survived, <span class="at">ref =</span> <span class="st">"Yes"</span>)</span>
<span id="cb70-2"><a href="#cb70-2"></a>titanic.raw<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">relevel</span>(titanic.raw<span class="sc">$</span>Sex, <span class="at">ref =</span> <span class="st">"Female"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="cociente-de-probabilidad-en-r-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Cociente de probabilidad en R</h2>
<div class="columns">
<div class="column fragment" style="width:55%;">
<ol start="3" type="1">
<li>Creamos la tabla de contingencia</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>tabla_cont <span class="ot">&lt;-</span> <span class="fu">table</span>(titanic.raw<span class="sc">$</span>Sex, titanic.raw<span class="sc">$</span>Survived)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:45%;">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a>tabla_cont</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        
          Yes   No
  Female  344  126
  Male    367 1364</code></pre>
</div>
</div>
</div>
</div>
<div class="fragment">
<div class="columns">
<div class="column fragment" style="width:55%;">
<ol start="4" type="1">
<li>Calculamos el OR</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>oddratio <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(tabla_cont)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:45%;">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>oddratio </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  tabla_cont
p-value &lt; 2.2e-16
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  7.97665 12.92916
sample estimates:
odds ratio 
   10.1319 </code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="c√≥mo-interpretamos-estos-resultados" class="slide level2 smaller">
<h2>¬øC√≥mo interpretamos estos resultados?</h2>
<div class="columns">
<div class="column" style="width:45%;">
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a>oddratio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Fisher's Exact Test for Count Data

data:  tabla_cont
p-value &lt; 2.2e-16
alternative hypothesis: true odds ratio is not equal to 1
95 percent confidence interval:
  7.97665 12.92916
sample estimates:
odds ratio 
   10.1319 </code></pre>
</div>
</div>
</div><div class="column" style="width:55%;">
<div>
<ul>
<li class="fragment"><p>Vemos que el cociente de probabilidad (OR) es 10. La interpretaci√≥n es: durante el hundimiento del Titanic fue 10 veces m√°s probable que un pasajero se salve si este era mujer.</p></li>
<li class="fragment"><p>Adicionalmente, del valor p de la prueba estad√≠stica exacta de Fisher menor al 0.05, se puede concluir que este cociente de probabilidad es significativo. En otras palabras, existe evidencia estad√≠stica significativa para afirmar que las probabilidades de sobrevivir durante el hundimiento del Titanic fueron 10 veces m√°s para pasajeras mujeres en comparaci√≥n a los hombres.</p></li>
</ul>
</div>
</div>
</div>
</section></section>
<section>
<section id="an√°lisis-de-varianza-anova" class="title-slide slide level1 center">
<h1>An√°lisis de Varianza (ANOVA)</h1>

</section>
<section id="introducci√≥n" class="slide level2">
<h2>Introducci√≥n</h2>
<div>
<ul>
<li class="fragment"><p>Hasta el momento nos hemos enfocado a los casos donde comparamos las medias entre dos grupos.</p></li>
<li class="fragment"><p>Pero es m√°s com√∫n el evaluar distintos tratamientos al mismo tiempo, como ya vimos en el m√≥dulo 2 del curso.</p></li>
<li class="fragment"><p>Para ello, contamos con el ANOVA, desarrollado por el estad√≠stico Ronald Fisher a inicios del siglo 20, y que sin duda es el m√©todo estad√≠stico m√°s usado hoy en d√≠a.</p></li>
<li class="fragment"><p>Su nombre puede ser confuso. <span class="fragment">El objetivo de un ANOVA es el de determinar la existencia de diferencias entre las medias aritm√©ticas de las muestras representativas de <span class="math inline">\(n\)</span> poblaciones (o en t√©rminos m√°s precisos, tratamientos).</span></p></li>
</ul>
</div>
</section>
<section id="supuestos-del-anova" class="slide level2 smaller">
<h2>Supuestos del ANOVA</h2>
<div>
<ol type="1">
<li class="fragment"><p>Independencia de los datos: conseguida mediante una correcta randomizaci√≥n y definici√≥n del experimento.</p></li>
<li class="fragment"><p>Homogeneidad de las varianzas: la varianza entre los tratamientos es la misma.</p></li>
<li class="fragment"><p><strong>Normalidad</strong>: <span class="fragment">pero, ¬øde qu√© exactamente?</span></p></li>
</ol>
<ul>
<li class="fragment"><p>Siempre ha existido una confusi√≥n de este supuesto. C√≥mo vimos antes, la normalidad es un requisito para conducir pruebas t, y lo es tambi√©n para el ANOVA.</p></li>
<li class="fragment"><p>Muchos libros de texto y otros recursos, mencionan que los datos de cada tratamiento deben ser normalmente distribuidos para llevar a cabo un ANOVA. <span class="fragment">Esto es cierto e impr√°ctico a la vez.</span></p></li>
<li class="fragment"><p>Mencionamos que como m√≠nimo deber√≠amos contar con 3 repeticiones por tratamiento. <span class="fragment">Pero, ¬øson 3 repeticiones suficientes para alcanzar la normalidad?</span></p></li>
<li class="fragment"><p>Es com√∫n el sugerir el llevar a cabo una prueba de normalidad antes de llevar a cabo un ANOVA, pero esto tiene varios problemas que supongo no te han dicho antes:</p>
<ul>
<li class="fragment"><p>Cada tratamiento tiene su propia media, en caso de medias muy distantes entre s√≠, la prueba puede fallar.</p></li>
<li class="fragment"><p>En su lugar, podr√≠as correr una prueba por cada tratamiento. Esto solo funciona con un considerable n√∫mero de observaciones/tratamiento (3 no son suficientes).</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="supuestos-del-anova-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>Supuestos del ANOVA</h2>
<div>
<ul>
<li class="fragment"><p>Esta confusi√≥n nos puede llevar a soluciones err√≥neas como transformar datos, borrar outliers o utilizar pruebas no param√©tricas innecesariamente.</p></li>
<li class="fragment"><p>Entonces, ¬ø<strong>normalidad</strong> de qu√©?</p></li>
<li class="fragment"><p>De los residuales estandarizados!‚Ä¶ <span class="fragment">¬øQu√© es un residual?</span></p>
<ul>
<li class="fragment"><p>Un residual es la diferencia entre una observaci√≥n y su predicci√≥n</p></li>
<li class="fragment"><p>Un residual estandarizado resulta de la divisi√≥n del residual para la ra√≠z cuadrada de la predicci√≥n</p></li>
<li class="fragment"><p>La distribuci√≥n muestral de los residuales estandarizados tiene media 0 y desviaci√≥n est√°ndar 1</p></li>
</ul></li>
<li class="fragment"><p>Y es sobre esta distribuci√≥n que los valores cr√≠ticos del ANOVA (valores F) son calculados. Es decir, estos no dependen enteramente de los datos originales, por lo tanto los datos originales no tienen que ser necesariamente normalmente distribuidos.</p></li>
<li class="fragment"><p>Pero, ¬øpor qu√© la confusi√≥n? <span class="fragment">Solo cuando el n√∫mero de observaciones es lo suficientemente grande (y ya sabemos que distribuci√≥n tiene la media muestral cuando el n√∫mero incrementa), se tiene la certeza que los residuales ser√°n normalmente distribuidos.</span></p></li>
<li class="fragment"><p>En resumen, es mejor chequear la normalidad despu√©s que realizamos el ANOVA.</p></li>
</ul>
</div>
</section>
<section id="el-dataset-de-recursos-por-depredaci√≥n" class="slide level2">
<h2>El dataset de recursos por depredaci√≥n</h2>

<img data-src="images/frog.jpg" class="r-stretch quarto-figure-center"><div class="footer">
<p>Imagen tomada por <a href="https://pixabay.com/users/12019-12019/?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=69813" target="_blank">David Mark</a> de <a href="https://pixabay.com//?utm_source=link-attribution&amp;utm_medium=referral&amp;utm_campaign=image&amp;utm_content=69813" target="_blank">Pixabay</a></p>
</div>
</section>
<section id="el-dataset-de-recursos-por-depredaci√≥n-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>El dataset de recursos por depredaci√≥n</h2>
<div>
<ul>
<li class="fragment"><p>Los datos que usaremos en esta y otras secciones corresponden a un experimento del <a href="https://www.jstor.org/stable/23436298" target="_blank">Prof.&nbsp;Justin C. Touchon</a> acerca de la interacci√≥n entre predadores y recursos.</p></li>
<li class="fragment"><p>El experimento consisti√≥ de m√∫ltiples tanques (mesocosmos) dispuestos al aire libre en Gamboa, Panam√°. Los investigadores ten√≠an por objetivo el saber como la variaci√≥n en la incubaci√≥n de huevos de la rana arb√≥rea de ojos rojos podr√≠a afectar su desarrollo hasta la metamorfosis bajo varias combinaciones de recursos y predadores.</p></li>
<li class="fragment"><p>Los tratamientos fueron los siguientes:</p>
<ul>
<li class="fragment"><p>Edad de incubaci√≥n: Temprana (<code>E</code>: 4 d√≠as despu√©s de la oviposici√≥n) o tard√≠a (<code>L</code>: 6 d√≠as despu√©s de la oviposici√≥n).</p></li>
<li class="fragment"><p>Predadores: control (<code>C</code>), no letal (<code>NL</code>: larvas de lib√©lula enjauladas) y letal (<code>L</code>: larvas de lib√©lula libres)</p></li>
<li class="fragment"><p>Recursos: bajo (<code>Lo</code>: 0.75 g) o alto (<code>Hi</code>: 1.5 g) de comida suministrados cada 5 d√≠as.</p></li>
</ul></li>
<li class="fragment"><p>Los mesocosmos fueron colocados en 8 bloques de 12 tanques cada uno.</p></li>
<li class="fragment"><p>El experimento inici√≥ con 50 renacuajos por tanque y termin√≥ cuando todos los renacuajos alcanzaron la metamorfosis, o murieron.</p></li>
</ul>
</div>
</section>
<section id="el-dataset-de-recursos-por-depredaci√≥n-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>El dataset de recursos por depredaci√≥n</h2>
<div>
<ul>
<li class="fragment"><p>Variables de respuesta:</p>
<ul>
<li class="fragment"><p>Edad de metaformosis contada desde el d√≠a de oviposici√≥n (<code>Age.DPO</code>).</p></li>
<li class="fragment"><p>Edad de salida del agua (<code>Age.FromEmergence</code>)</p></li>
<li class="fragment"><p>Longitud nariz-cloaca al emerger (<code>SVL.initial</code>)</p></li>
<li class="fragment"><p>Longitud de la cola al emerger (<code>Tail.initial</code>)</p></li>
<li class="fragment"><p>Longitud nariz-cloaca al t√©rmino de la reabsorci√≥n de la cola (<code>SVL.final</code>)</p></li>
<li class="fragment"><p>Peso al t√©rmino de la reabsorci√≥n de la cola (<code>Mass.final</code>)</p></li>
<li class="fragment"><p>N√∫mero de d√≠as requeridos por cada metamorfo para reabsorber completamente la cola (<code>Resorb.days</code>)</p></li>
</ul></li>
<li class="fragment"><p>18 tanques conteniendo predadores no letales fueron descartados debido al brote de una enfermedad.</p></li>
<li class="fragment"><p><strong>NOTA:</strong> el dataset original de Touchon contiene alrededor de 2500 observaciones. Sin embargo, para poder usar los datos bajo los supuestos del ANOVA es necesario reducirlos a las medias aritm√©ticas de cada tratamiento por cuanto se tratan de pseudo repeticiones. Esta reducci√≥n ya est√° hecha en el archivo ‚Äútouchon.csv‚Äù disponible con el <a href="https://mmorenozam.github.io/est-apl-uce-2023-website/materiales.html" target="_blank">resto de materiales extras del curso.</a></p></li>
</ul>
</div>
</section>
<section id="anova-de-una-v√≠a" class="slide level2 smaller">
<h2>ANOVA de una v√≠a</h2>
<div>
<ul>
<li class="fragment"><p>ANOVA de una v√≠a se refiere cuando tenemos m√°s de dos tratamientos que est√°n definidos por un solo factor a la vez.</p></li>
<li class="fragment"><p>Usando los datos del Prof.&nbsp;Touchon, vamos a ilustrar el caso del ANOVA de una v√≠a. Para ello, vamos a considerar lo siguiente</p>
<ul>
<li class="fragment"><p>Supongamos que estamos interesados en saber si existe alguna diferencia entre la edad de salida del agua <code>Age.FromEmergence</code> determinada por los predadores:</p></li>
<li class="fragment"><p>Los niveles del factor predadores son:</p>
<ul>
<li class="fragment"><p>Predadores no letales <code>NL</code></p></li>
<li class="fragment"><p>Predadores letales <code>L</code></p></li>
<li class="fragment"><p>Control (sin predadores) <code>C</code></p></li>
</ul></li>
</ul></li>
<li class="fragment"><p>La <span class="math inline">\(H_0\)</span> en todo ANOVA es simplemente que no existe diferencia entre <span class="math inline">\(n\)</span> tratamientos, y la <span class="math inline">\(H_a\)</span> es que al menos uno de los tratamientos tiene una media distinta.</p></li>
</ul>
</div>
</section>
<section id="anova-en-r" class="slide level2">
<h2>ANOVA en R</h2>
<div>
<ul>
<li class="fragment"><p>Existen dos formas de llevar a cabo ANOVA en R:</p>
<ol type="1">
<li class="fragment"><p>Crear un modelo lineal con la funci√≥n <code>lm</code> y luego llevar a cabo el ANOVA con la funci√≥n <code>anova</code> sobre el objeto producto de <code>lm</code>.</p></li>
<li class="fragment"><p>Aplicar directamente la funci√≥n <code>aov</code> sobre nuestros datos.</p></li>
</ol></li>
<li class="fragment"><p>Ambas funciones (<code>lm</code> y <code>aov</code>) tienen la misma sintaxis. <span class="fragment">Personalmente prefiero la primera opci√≥n.</span></p></li>
<li class="fragment"><p>Adicionalmente, la librer√≠a <code>car</code> ofrece la funci√≥n <code>Anova</code>. El resultado de ambas es pr√°cticamente el mismo para la mayor√≠a de modelos. <span class="fragment">Sin embargo, personalmente prefiero <code>Anova</code> ya que permite realizar correcciones cuando tenemos datos no balanceados.</span></p></li>
</ul>
</div>
</section>
<section id="anova-de-una-v√≠a-en-r" class="slide level2">
<h2>ANOVA de una v√≠a en R</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<p>Opci√≥n 1</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb79" data-code-line-numbers="1|2|3|4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="fu">library</span>(car)</span>
<span id="cb79-2"><a href="#cb79-2"></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"touchon.csv"</span>)</span>
<span id="cb79-3"><a href="#cb79-3"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="fu">Anova</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<p>Opci√≥n 2</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb80" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"touchon.csv"</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a>anova1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="fu">summary</span>(anova1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: Age.FromEmergence
          Sum Sq Df F value    Pr(&gt;F)    
Pred        9467  2  10.442 9.986e-05 ***
Residuals  33999 75                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Pred         2   9467    4733   10.44 9.99e-05 ***
Residuals   75  33999     453                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="normalidad-de-los-datos-residuales" class="slide level2">
<h2>Normalidad de los datos (residuales)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb83" data-code-line-numbers="4|5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a><span class="fu">library</span>(car)</span>
<span id="cb83-2"><a href="#cb83-2"></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"touchon.csv"</span>)</span>
<span id="cb83-3"><a href="#cb83-3"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb83-4"><a href="#cb83-4"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb83-5"><a href="#cb83-5"></a><span class="fu">plot</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="normalidad-de-los-datos-residuales-1" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Normalidad de los datos (residuales)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">library</span>(car)</span>
<span id="cb84-2"><a href="#cb84-2"></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"touchon.csv"</span>)</span>
<span id="cb84-3"><a href="#cb84-3"></a>lm1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(Age.FromEmergence <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="fu">plot</span>(lm1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-55-1.png" width="576" class="r-stretch quarto-figure-center"></section>
<section id="normalidad-de-los-datos-residuales-2" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Normalidad de los datos (residuales)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb85" data-code-line-numbers="3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a><span class="fu">library</span>(car)</span>
<span id="cb85-2"><a href="#cb85-2"></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"touchon.csv"</span>)</span>
<span id="cb85-3"><a href="#cb85-3"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.FromEmergence) <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb85-4"><a href="#cb85-4"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb85-5"><a href="#cb85-5"></a><span class="fu">plot</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="normalidad-de-los-datos-residuales-3" class="slide level2" data-visibility="uncounted" data-autoanimate="true">
<h2>Normalidad de los datos (residuales)</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">library</span>(car)</span>
<span id="cb86-2"><a href="#cb86-2"></a>ranas <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"touchon.csv"</span>)</span>
<span id="cb86-3"><a href="#cb86-3"></a>lm2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.FromEmergence) <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="fu">plot</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-57-1.png" width="576" class="r-stretch quarto-figure-center"></section>
<section id="prueba-formal-de-normalidad" class="slide level2">
<h2>Prueba formal de normalidad</h2>
<div>
<ul>
<li class="fragment"><p>Como vimos, despu√©s de aplicar la transformaci√≥n logar√≠tmica el gr√°fico Q-Q mejor√≥ considerablemente.</p></li>
<li class="fragment"><p>Para estar seguros, podemos correr un test formal sobre los residuales del modelo con la ayuda de la librer√≠a <code>olsrr</code> mediante su funci√≥n <code>ols_test_normality</code>.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb87-2"><a href="#cb87-2"></a><span class="fu">ols_test_normality</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------------
       Test             Statistic       pvalue  
-----------------------------------------------
Shapiro-Wilk              0.9802         0.2645 
Kolmogorov-Smirnov        0.0893         0.5625 
Cramer-von Mises          8.6738         0.0000 
Anderson-Darling          0.5447         0.1566 
-----------------------------------------------</code></pre>
</div>
</div>
</div>
</section>
<section id="prueba-formal-de-normalidad-1" class="slide level2" data-visibility="uncounted">
<h2>Prueba formal de normalidad</h2>
<div>
<ul>
<li class="fragment">O tambi√©n podemos calcular la prueba de Shapiro-Wilk con funciones base de R</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1"></a>residuales <span class="ot">&lt;-</span> <span class="fu">resid</span>(lm2)</span>
<span id="cb89-2"><a href="#cb89-2"></a><span class="fu">shapiro.test</span>(residuales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuales
W = 0.98017, p-value = 0.2645</code></pre>
</div>
</div>
</div>
</section>
<section id="homogeneidad-de-las-varianzas-en-anova" class="slide level2">
<h2>Homogeneidad de las varianzas en ANOVA</h2>
<div>
<ul>
<li class="fragment"><p>La prueba m√°s usada para chequear la homogeneidad de varianzas de un ANOVA es la de Levene.</p></li>
<li class="fragment"><p>Para ello utilizaremos la funci√≥n <code>leveneTest</code> de la librer√≠a <code>car</code>. Podemos usar esta funci√≥n directamente sobre los datos con la misma sintaxis de <code>lm</code>, o sobre el objeto <code>lm2</code> en el que anteriormente almacenamos el resultado del modelo lineal con la transformaci√≥n.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">leveneTest</span>(lm2, <span class="at">center =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "mean")
      Df F value  Pr(&gt;F)  
group  2  3.0464 0.05345 .
      75                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</section>
<section id="anova-de-una-v√≠a-en-r-continuaci√≥n" class="slide level2">
<h2>ANOVA de una v√≠a en R (continuaci√≥n)</h2>
<div>
<ul>
<li class="fragment">As√≠, una vez que hemos transformado para obtener normalidad en los residuales y chequeado la homogeneidad de varianzas, es tiempo de hecharle un vistazo al resultado del ANOVA:</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="fu">Anova</span>(lm2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: log(Age.FromEmergence)
          Sum Sq Df F value    Pr(&gt;F)    
Pred       9.710  2  12.389 2.244e-05 ***
Residuals 29.392 75                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Por tanto, podemos concluir que al menos uno de los tratamientos es distinto (aceptamos la <span class="math inline">\(H_a\)</span> y rechazamos la <span class="math inline">\(H_0\)</span>)</li>
</ul>
</div>
</section>
<section id="qu√©-tan-distintos" class="slide level2 smaller">
<h2>¬øQu√© tan distintos?</h2>
<div>
<ul>
<li class="fragment"><p>Preguntas naturales seguidas de estos resultados son: ¬øqu√© tan distintos son los tratamientos entre s√≠?, ¬øpuedo acaso ordernarlos de mayor a menor?, ¬øexisten pares de tratamientos que son iguales?</p></li>
<li class="fragment"><p>Podemos comenzar con una ayuda visual (que pudo bien haber sido parte de nuestro AED)</p></li>
</ul>
</div>
<div class="fragment">
<div class="panel-tabset">
<ul id="tabset-1" class="panel-tabset-tabby"><li><a data-tabby-default="" href="#tabset-1-1">C√≥digo</a></li><li><a href="#tabset-1-2">Gr√°fico</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb95-2"><a href="#cb95-2"></a><span class="fu">qplot</span>(Pred, Age.FromEmergence,</span>
<span id="cb95-3"><a href="#cb95-3"></a>      <span class="at">colour =</span> Pred,</span>
<span id="cb95-4"><a href="#cb95-4"></a>      <span class="at">geom =</span> <span class="fu">c</span>(<span class="st">"boxplot"</span>, <span class="st">"jitter"</span>),</span>
<span id="cb95-5"><a href="#cb95-5"></a>      <span class="at">data =</span> ranas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-63-1.png" width="960"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="comparaciones-m√∫ltiples" class="slide level2">
<h2>Comparaciones m√∫ltiples</h2>
<div>
<ul>
<li class="fragment"><p>Los m√©todos de comparaciones m√∫ltiples nos ayudan a responder estas preguntas.</p></li>
<li class="fragment"><p>Los m√°s usados son:</p>
<ul>
<li class="fragment"><p>HSD Tukey (<em>Honestly significant difference</em>): lleva a cabo todos los pares de comparaciones posibles entre los niveles de un factor.</p></li>
<li class="fragment"><p>Prueba de Dunnett: Compara los niveles √∫nicamente con respecto al nivel control dentro del factor.</p></li>
</ul></li>
<li class="fragment"><p>Son conocidos como pruebas o comparaciones <em>post-hoc</em>.</p></li>
<li class="fragment"><p>En R, la manera m√°s sencilla de llevar a cabo comparaciones m√∫ltiples es mediante las librer√≠as <code>emmeans</code> y <code>multcomp</code>.</p></li>
</ul>
</div>
</section>
<section id="comparaciones-m√∫ltiples-1" class="slide level2 smaller">
<h2>Comparaciones m√∫ltiples</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96" data-code-line-numbers="1|2|3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb96-2"><a href="#cb96-2"></a>ph1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm2, <span class="at">specs =</span> <span class="st">"Pred"</span>)</span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="fu">summary</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparaciones-m√∫ltiples-2" class="slide level2 smaller" data-visibility="uncounted" data-autoanimate="true">
<h2>Comparaciones m√∫ltiples</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb97-2"><a href="#cb97-2"></a>ph1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm2, <span class="at">specs =</span> <span class="st">"Pred"</span>)</span>
<span id="cb97-3"><a href="#cb97-3"></a><span class="fu">summary</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Pred emmean    SE df lower.CL upper.CL
 C      3.53 0.111 75     3.31     3.75
 L      2.76 0.111 75     2.54     2.98
 NL     3.26 0.167 75     2.93     3.60

Results are given on the log (not the response) scale. 
Confidence level used: 0.95 </code></pre>
</div>
</div>
</section>
<section id="comparaciones-m√∫ltiples-3" class="slide level2 smaller" data-visibility="uncounted" data-autoanimate="true">
<h2>Comparaciones m√∫ltiples</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb99" data-code-line-numbers="1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>ph1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm2, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb99-2"><a href="#cb99-2"></a><span class="fu">summary</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="comparaciones-m√∫ltiples-4" class="slide level2 smaller" data-visibility="uncounted" data-autoanimate="true">
<h2>Comparaciones m√∫ltiples</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>ph1 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm2, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb100-2"><a href="#cb100-2"></a><span class="fu">summary</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Pred response   SE df lower.CL upper.CL
 C        34.2 3.79 75     27.4     42.6
 L        15.8 1.75 75     12.7     19.7
 NL       26.2 4.38 75     18.8     36.5

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li>Y terminamos con <code>multcomp</code></li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="co"># multcomp necesita una librer√≠a extra llamada multcompView</span></span>
<span id="cb102-2"><a href="#cb102-2"></a><span class="co"># No olvides instalar multcompView antes de correr este c√≥digo</span></span>
<span id="cb102-3"><a href="#cb102-3"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb102-4"><a href="#cb102-4"></a><span class="fu">cld</span>(ph1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Pred response   SE df lower.CL upper.CL .group
 L        15.8 1.75 75     12.7     19.7  1    
 NL       26.2 4.38 75     18.8     36.5   2   
 C        34.2 3.79 75     27.4     42.6   2   

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</div>
</section>
<section id="antes-de-continuar-3" class="slide level2">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment">En este punto, antes de continuar hagamos uso nuevamente de la librer√≠a <code>flextable</code> para exportar nuestras tablas a Word.</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb104-2"><a href="#cb104-2"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">flextable</span>(<span class="fu">Anova</span>(lm2))</span>
<span id="cb104-3"><a href="#cb104-3"></a>tabla_tukey <span class="ot">&lt;-</span> <span class="fu">flextable</span>(<span class="fu">cld</span>(ph1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-88d8b11c{}.cl-88cd67a8{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88d244e4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88d25ab0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88d25ab1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88d25aba{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-88d8b11c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-88d25ab0"><p class="cl-88d244e4"><span class="cl-88cd67a8">Sum Sq</span></p></th><th class="cl-88d25ab0"><p class="cl-88d244e4"><span class="cl-88cd67a8">Df</span></p></th><th class="cl-88d25ab0"><p class="cl-88d244e4"><span class="cl-88cd67a8">F value</span></p></th><th class="cl-88d25ab0"><p class="cl-88d244e4"><span class="cl-88cd67a8">Pr(&gt;F)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-88d25ab1"><p class="cl-88d244e4"><span class="cl-88cd67a8">9.710023</span></p></td><td class="cl-88d25ab1"><p class="cl-88d244e4"><span class="cl-88cd67a8">2</span></p></td><td class="cl-88d25ab1"><p class="cl-88d244e4"><span class="cl-88cd67a8">12.38871</span></p></td><td class="cl-88d25ab1"><p class="cl-88d244e4"><span class="cl-88cd67a8">0.00002244333</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88d25aba"><p class="cl-88d244e4"><span class="cl-88cd67a8">29.391750</span></p></td><td class="cl-88d25aba"><p class="cl-88d244e4"><span class="cl-88cd67a8">75</span></p></td><td class="cl-88d25aba"><p class="cl-88d244e4"><span class="cl-88cd67a8"></span></p></td><td class="cl-88d25aba"><p class="cl-88d244e4"><span class="cl-88cd67a8"></span></p></td></tr></tbody></table></div>
</div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-88e5c8e8{}.cl-88dc6730{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88dfef0e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88dfef18{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88e00d40{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88e00d4a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88e00d54{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88e00d55{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88e00d56{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88e00d57{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-88e5c8e8"><thead><tr style="overflow-wrap:break-word;"><th class="cl-88e00d40"><p class="cl-88dfef0e"><span class="cl-88dc6730">Pred</span></p></th><th class="cl-88e00d4a"><p class="cl-88dfef18"><span class="cl-88dc6730">response</span></p></th><th class="cl-88e00d4a"><p class="cl-88dfef18"><span class="cl-88dc6730">SE</span></p></th><th class="cl-88e00d4a"><p class="cl-88dfef18"><span class="cl-88dc6730">df</span></p></th><th class="cl-88e00d4a"><p class="cl-88dfef18"><span class="cl-88dc6730">lower.CL</span></p></th><th class="cl-88e00d4a"><p class="cl-88dfef18"><span class="cl-88dc6730">upper.CL</span></p></th><th class="cl-88e00d40"><p class="cl-88dfef0e"><span class="cl-88dc6730">.group</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-88e00d54"><p class="cl-88dfef0e"><span class="cl-88dc6730">L</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">15.79873</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">1.748353</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">75</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">12.67301</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">19.69537</span></p></td><td class="cl-88e00d54"><p class="cl-88dfef0e"><span class="cl-88dc6730"> 1 </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88e00d54"><p class="cl-88dfef0e"><span class="cl-88dc6730">NL</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">26.17238</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">4.378862</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">75</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">18.75403</span></p></td><td class="cl-88e00d55"><p class="cl-88dfef18"><span class="cl-88dc6730">36.52512</span></p></td><td class="cl-88e00d54"><p class="cl-88dfef0e"><span class="cl-88dc6730">  2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-88e00d56"><p class="cl-88dfef0e"><span class="cl-88dc6730">C</span></p></td><td class="cl-88e00d57"><p class="cl-88dfef18"><span class="cl-88dc6730">34.20777</span></p></td><td class="cl-88e00d57"><p class="cl-88dfef18"><span class="cl-88dc6730">3.785575</span></p></td><td class="cl-88e00d57"><p class="cl-88dfef18"><span class="cl-88dc6730">75</span></p></td><td class="cl-88e00d57"><p class="cl-88dfef18"><span class="cl-88dc6730">27.43991</span></p></td><td class="cl-88e00d57"><p class="cl-88dfef18"><span class="cl-88dc6730">42.64488</span></p></td><td class="cl-88e00d56"><p class="cl-88dfef0e"><span class="cl-88dc6730">  2</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="antes-de-continuar-4" class="slide level2" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<ul>
<li>En este punto, antes de continuar hagamos uso nuevamente de la librer√≠a <code>flextable</code> para exportar nuestras tablas a Word.</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb105-2"><a href="#cb105-2"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">Anova</span>(lm2)), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb105-3"><a href="#cb105-3"></a>tabla_tukey <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">cld</span>(ph1)), <span class="at">digits =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div class="tabwid"><style>.cl-890f1f9a{}.cl-890590ec{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8909ae48{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-8909c0d6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8909c0e0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8909c0e1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-890f1f9a"><thead><tr style="overflow-wrap:break-word;"><th class="cl-8909c0d6"><p class="cl-8909ae48"><span class="cl-890590ec">Sum Sq</span></p></th><th class="cl-8909c0d6"><p class="cl-8909ae48"><span class="cl-890590ec">Df</span></p></th><th class="cl-8909c0d6"><p class="cl-8909ae48"><span class="cl-890590ec">F value</span></p></th><th class="cl-8909c0d6"><p class="cl-8909ae48"><span class="cl-890590ec">Pr(&gt;F)</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-8909c0e0"><p class="cl-8909ae48"><span class="cl-890590ec">9.710</span></p></td><td class="cl-8909c0e0"><p class="cl-8909ae48"><span class="cl-890590ec">2.000</span></p></td><td class="cl-8909c0e0"><p class="cl-8909ae48"><span class="cl-890590ec">12.389</span></p></td><td class="cl-8909c0e0"><p class="cl-8909ae48"><span class="cl-890590ec">0.000</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-8909c0e1"><p class="cl-8909ae48"><span class="cl-890590ec">29.392</span></p></td><td class="cl-8909c0e1"><p class="cl-8909ae48"><span class="cl-890590ec">75.000</span></p></td><td class="cl-8909c0e1"><p class="cl-8909ae48"><span class="cl-890590ec"></span></p></td><td class="cl-8909c0e1"><p class="cl-8909ae48"><span class="cl-890590ec"></span></p></td></tr></tbody></table></div>
</div>
<div class="cell-output-display">

<div class="tabwid"><style>.cl-891c451c{}.cl-8912b452{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-891669da{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-891669e4{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-89167dbc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89167dbd{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89167dc6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89167dd0{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89167dd1{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89167dda{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table data-quarto-disable-processing="true" class="cl-891c451c"><thead><tr style="overflow-wrap:break-word;"><th class="cl-89167dbc"><p class="cl-891669da"><span class="cl-8912b452">Pred</span></p></th><th class="cl-89167dbd"><p class="cl-891669e4"><span class="cl-8912b452">response</span></p></th><th class="cl-89167dbd"><p class="cl-891669e4"><span class="cl-8912b452">SE</span></p></th><th class="cl-89167dbd"><p class="cl-891669e4"><span class="cl-8912b452">df</span></p></th><th class="cl-89167dbd"><p class="cl-891669e4"><span class="cl-8912b452">lower.CL</span></p></th><th class="cl-89167dbd"><p class="cl-891669e4"><span class="cl-8912b452">upper.CL</span></p></th><th class="cl-89167dbc"><p class="cl-891669da"><span class="cl-8912b452">.group</span></p></th></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-89167dc6"><p class="cl-891669da"><span class="cl-8912b452">L</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">15.799</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">1.748</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">75.000</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">12.673</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">19.695</span></p></td><td class="cl-89167dc6"><p class="cl-891669da"><span class="cl-8912b452"> 1 </span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89167dc6"><p class="cl-891669da"><span class="cl-8912b452">NL</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">26.172</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">4.379</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">75.000</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">18.754</span></p></td><td class="cl-89167dd0"><p class="cl-891669e4"><span class="cl-8912b452">36.525</span></p></td><td class="cl-89167dc6"><p class="cl-891669da"><span class="cl-8912b452">  2</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-89167dd1"><p class="cl-891669da"><span class="cl-8912b452">C</span></p></td><td class="cl-89167dda"><p class="cl-891669e4"><span class="cl-8912b452">34.208</span></p></td><td class="cl-89167dda"><p class="cl-891669e4"><span class="cl-8912b452">3.786</span></p></td><td class="cl-89167dda"><p class="cl-891669e4"><span class="cl-8912b452">75.000</span></p></td><td class="cl-89167dda"><p class="cl-891669e4"><span class="cl-8912b452">27.440</span></p></td><td class="cl-89167dda"><p class="cl-891669e4"><span class="cl-8912b452">42.645</span></p></td><td class="cl-89167dd1"><p class="cl-891669da"><span class="cl-8912b452">  2</span></p></td></tr></tbody></table></div>
</div>
</div>
</div>
</section>
<section id="antes-de-continuar-5" class="slide level2" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a><span class="fu">library</span>(flextable)</span>
<span id="cb106-2"><a href="#cb106-2"></a>tabla_anova <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">Anova</span>(lm2)), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb106-3"><a href="#cb106-3"></a>tabla_tukey <span class="ot">&lt;-</span> <span class="fu">colformat_double</span>(<span class="fu">flextable</span>(<span class="fu">cld</span>(ph1)), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb106-4"><a href="#cb106-4"></a></span>
<span id="cb106-5"><a href="#cb106-5"></a><span class="fu">save_as_docx</span>(<span class="st">"Tabla Anova"</span> <span class="ot">=</span> tabla_anova, <span class="st">"Tabla Anova"</span> <span class="ot">=</span> tabla_tukey,</span>
<span id="cb106-6"><a href="#cb106-6"></a>             <span class="at">path =</span> <span class="st">"C:/Users/mmore/Documents/cursos_uce_2023/modulos/uce2023-modulo4/anova.docx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="images/anova_tabla.png" class="r-stretch quarto-figure-center"></section>
<section id="anova-de-un-dise√±o-desbalanceado" class="slide level2 smaller">
<h2>ANOVA de un dise√±o desbalanceado</h2>
<div>
<ul>
<li class="fragment"><p>Recordemos que 18 tanques con predadores no letales fueron descartados debido al brote de una enfermedad.</p></li>
<li class="fragment"><p>El dise√±o original de Touchon era balanceado. Al perderse unidades experimentales, el dise√±o se le puede denominar como desbalanceado. En otras palabras, el desbalance es la p√©rdida de observaciones.</p></li>
<li class="fragment"><p>La mayor√≠a de m√©todos estad√≠sticos requieren ser corregidos ante observaciones perdidas para poder tener la certeza de que los estimados que obtenemos no sean sesgados.</p></li>
<li class="fragment"><p>Sin adentrarnos en mayor detalle, uno de los componentes de la tabla de ANOVA es la suma de cuadrados. Existen tres tipos de suma de cuadrados: I, II y III.</p></li>
<li class="fragment"><p>En breve, las sumas II y III se aconseja sean usadas cuando existen interacciones en el ANOVA.</p></li>
<li class="fragment"><p>En R, la funci√≥n <code>aov</code> calcula la suma de cuadrados tipo I. Este tipo de suma no es conveniente ante la presencia de desbalance de los datos.</p></li>
<li class="fragment"><p>En cambio, la funci√≥n <code>Anova</code> de la librer√≠a <code>car</code>, usa por default el tipo II que es precisamente el recomendado usar ante la presencia de desbalance.</p></li>
<li class="fragment"><p>En resumen, s√≠. Hemos utilizado hasta el momento la correcci√≥n adecuada para estos datos.</p></li>
</ul>
</div>
</section>
<section id="ejercicio-4.8" class="slide level2">
<h2>Ejercicio 4.8</h2>
<ul>
<li>Lleva a cabo un ANOVA con todos sus pasos para la variable <code>Resorb.days</code> de los datos de Touchon</li>
</ul>
</section>
<section id="prueba-de-kruskal-wallis" class="slide level2 smaller">
<h2>Prueba de Kruskal-Wallis</h2>
<div>
<ul>
<li class="fragment"><p>La prueba de Kruskal-Wallis es la alternativa no param√©trica al ANOVA de una v√≠a.</p></li>
<li class="fragment"><p>Puede extenderse al ANOVA de m√∫ltiples v√≠as reorganizando el dise√±o experimental.</p></li>
<li class="fragment"><p>Similar a las pruebas de Wilcoxon, se basa en encontrar diferencias de las medianas en lugar de las medias y su poder ese menor.</p></li>
<li class="fragment"><p>Para ilustrar este ejemplo, tomemos la variable <code>Age.DPO</code> del estudio de Touchon y veamos si existen diferencias con respecto al tratamiento de predador <code>Pred</code>. <code>Age.DPO</code> sin transformaciones no cumple con los supuestos del ANOVA.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="fu">kruskal.test</span>(Age.DPO <span class="sc">~</span> Pred, <span class="at">data =</span> ranas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Age.DPO by Pred
Kruskal-Wallis chi-squared = 22.255, df = 2, p-value = 1.47e-05</code></pre>
</div>
</div>
</div>
</section>
<section id="comparaciones-m√∫ltiples-con-kruskal-wallis" class="slide level2 smaller">
<h2>Comparaciones m√∫ltiples con Kruskal-Wallis</h2>
<div>
<ul>
<li class="fragment"><p>Con KW tambi√©n podemos llevar a cabo comparaciones m√∫ltiples.</p></li>
<li class="fragment"><p>En R base contamos con la funci√≥n <code>pairwise.wilcox.test</code> que lleva a cabo comparaciones por pares mediante el m√©todo de Wilcoxon.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">pairwise.wilcox.test</span>(ranas<span class="sc">$</span>Age.DPO, ranas<span class="sc">$</span>Pred, <span class="at">p.adjust.method =</span> <span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Pairwise comparisons using Wilcoxon rank sum test with continuity correction 

data:  ranas$Age.DPO and ranas$Pred 

   C       L    
L  9.8e-06 -    
NL 0.303   0.019

P value adjustment method: BH </code></pre>
</div>
</div>
</div>
</section>
<section id="ejercicio-4.9" class="slide level2">
<h2>Ejercicio 4.9</h2>
<ul>
<li>Encuentra si existen diferencias en la longitud nariz-cloaca al emerger (<code>SVL.initial</code>) con respecto a los predadores <code>Pred</code> en los datos de Touchon. ¬øQu√© m√©todo es factible usar?, ¬øANOVA de una v√≠a o Kruskal-Wallis?</li>
</ul>
</section>
<section id="antes-de-continuar-6" class="slide level2 smaller">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment"><p>Con respecto a los DDE que vimos en el m√≥dulo 2, el ANOVA de una v√≠a corresponde directamente al an√°lisis que llevar√≠amos a cabo para un DCA.</p></li>
<li class="fragment"><p>Para extender el modelo a un DBCA de una v√≠a basta el incorporar otro efecto principal en el modelo:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>lm3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.FromEmergence) <span class="sc">~</span> Pred <span class="sc">+</span> <span class="fu">as.factor</span>(Block), <span class="at">data =</span> ranas)</span>
<span id="cb111-2"><a href="#cb111-2"></a><span class="fu">Anova</span>(lm3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: log(Age.FromEmergence)
                  Sum Sq Df F value    Pr(&gt;F)    
Pred              9.8369  2 13.9265 8.526e-06 ***
as.factor(Block)  5.3760  7  2.1746   0.04728 *  
Residuals        24.0158 68                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div>
<ul>
<li class="fragment"><p>La interpretaci√≥n de este tipo de ANOVA se enfoca en el valor p de los tratamientos.</p></li>
<li class="fragment"><p>No tiene mucho sentido el interpretar el valor p del factor de bloque ya que est√° ah√≠ para controlar fuentes de variaci√≥n.</p></li>
<li class="fragment"><p>De manera similar, cuando extendamos el ANOVA a m√°s factores, el an√°lisis del DBCA factorial se consigue a√±adiendo un efecto principal para el bloque.</p></li>
</ul>
</div>
</div>
</section>
<section id="antes-de-continuar-7" class="slide level2 smaller" data-visibility="uncounted">
<h2>Antes de continuar</h2>
<div>
<ul>
<li class="fragment">Para llevar a cabo las pruebas de comparaciones m√∫ltiples, seguimos el mismo procedimiento que describimos anteriormente ignorando el efecto del bloque.</li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>ph_dbca <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm3, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb113-2"><a href="#cb113-2"></a><span class="fu">cld</span>(ph_dbca)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Pred response   SE df lower.CL upper.CL .group
 L        15.8 1.66 68     12.8     19.5  1    
 NL       27.6 4.89 68     19.4     39.3   2   
 C        34.2 3.59 68     27.7     42.2   2   

Results are averaged over the levels of: Block 
Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</div>
</section>
<section id="anova-de-m√∫ltiples-v√≠as" class="slide level2 smaller">
<h2>ANOVA de m√∫ltiples v√≠as</h2>
<div>
<ul>
<li class="fragment"><p>El ANOVA puede extenderse para analizar dos o m√°s factores a la vez. Su nombre entonces var√≠a dependiendo de cu√°ntos factores analicemos, as√≠: ANOVA de dos v√≠as (2 factores), ANOVA de tres v√≠as (3 factores) ‚Ä¶</p></li>
<li class="fragment"><p>En la pr√°ctica es recomendable dise√±ar experimentos hasta m√°ximo 3 factores:</p>
<ul>
<li class="fragment"><p>A m√°s factores, m√°s costosa la investigaci√≥n</p></li>
<li class="fragment"><p>A m√°s factores, sus interacciones son m√°s dif√≠ciles de interpretar</p></li>
<li class="fragment"><p>Es posible inclusive que tengamos resultados sin sentido (interacciones innecesarias)</p></li>
</ul></li>
<li class="fragment"><p>¬øQu√© son las interacciones?</p>
<ul>
<li class="fragment"><p>Una interacci√≥n se refiere cuando los niveles de un factor podr√≠an depender de los niveles de otro.</p></li>
<li class="fragment"><p>Por ejemplo, con los datos de las ranas, podr√≠amos imaginar que en la ausencia de predadores, tener recursos altos o bajos podr√≠a influenciar el tiempo que tomaron los renacuajos en culminar la metamorfosis. Es decir, si hay predadores presentes, podr√≠a darse el caso de que las presas se escondan y coman menos influenciando as√≠ ese tiempo.</p></li>
<li class="fragment"><p>As√≠, podr√≠amos saber si el effecto de los recursos son influenciados ante la presencia de predadores</p></li>
</ul></li>
</ul>
</div>
</section>
<section id="anova-de-m√∫ltiples-v√≠as-en-r" class="slide level2 smaller">
<h2>ANOVA de m√∫ltiples v√≠as en R</h2>
<div>
<ul>
<li class="fragment"><p>Vamos a usar nuevamente los datos de Touchon, la variable de respuesta es la edad de metamorfosis <code>Age.DPO</code> y los factores la presencia de predadores <code>Pred</code> y los recursos <code>Res</code>.</p></li>
<li class="fragment"><p>Para llevar a cabo un ANOVA de m√∫ltiples v√≠as en R podemos usar la siguiente sintaxis: <code>Factor1*Factor2</code></p></li>
<li class="fragment"><p>Para ahorrarnos tiempo, sup√≥ngamos que ya corrimos un primer ANOVA, y encontramos que usando el logaritmo de <code>Age.DPO</code> podemos normalizar los residuales. <span class="fragment">Pero nos encontramos con esto:</span></p></li>
</ul>
</div>
<div class="fragment">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>lm4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.DPO) <span class="sc">~</span> Pred<span class="sc">*</span>Res, <span class="at">data =</span> ranas)</span>
<span id="cb115-2"><a href="#cb115-2"></a><span class="fu">leveneTest</span>(lm4, <span class="at">center =</span> <span class="st">"mean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Levene's Test for Homogeneity of Variance (center = "mean")
      Df F value    Pr(&gt;F)    
group  5  6.0253 0.0001033 ***
      72                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div>
<ul>
<li class="fragment"><p><strong>¬°La homogeneidad de las varianzas no se cumple!</strong> üò±</p></li>
<li class="fragment"><p>Este es un escenario com√∫n y que quiz√° nos haga realmente considerar usar Kruskal-Wallis.</p></li>
<li class="fragment"><p>Sin embargo, hay una opci√≥n! <span class="fragment">La funci√≥n <code>Anova</code> de la librer√≠a <code>car</code> ofrece el argumento <code>white.adjust</code> que permite obtener un ANOVA corregido para <strong>heterodasticidad</strong> por el m√©todo de White-Huber.</span></p></li>
</ul>
</div>
</div>
</section>
<section id="anova-de-m√∫ltiples-v√≠as-en-r-1" class="slide level2 smaller scrollable">
<h2>ANOVA de m√∫ltiples v√≠as en R</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a><span class="fu">Anova</span>(lm4, <span class="at">white.adjust =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type II tests)

Response: log(Age.DPO)
          Df       F    Pr(&gt;F)    
Pred       2 19.3707 1.857e-07 ***
Res        1 28.4555 1.059e-06 ***
Pred:Res   2  3.7678   0.02778 *  
Residuals 72                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="fragment">
<div>
<ul>
<li class="fragment"><p>Como vemos, existen dos efectos principales (predador y recursos) y su interacci√≥n (predador <span class="math inline">\(\times\)</span> recursos).</p></li>
<li class="fragment"><p>Aqu√≠ encontramos que la interacci√≥n es significativa. Esto lo podemos interpretar as√≠: ‚Äúexiste evidencia estad√≠stica significativa para concluir que la edad de metamorfosis de los renacuajos depende de una interacci√≥n entre la alimentaci√≥n y la presencia de predadores‚Äù.</p></li>
<li class="fragment"><p>Y ¬øpor qu√© solo interpretamos la interacci√≥n?:</p>
<ul>
<li class="fragment"><p>Cuando la interacci√≥n y los efectos principales son significativos, basta con interpretar la primera.</p></li>
<li class="fragment"><p>Cuando la interacci√≥n es significativa y uno de los efectos principales no lo es, hay que ir en m√°s detalle del por qu√©.</p></li>
</ul></li>
<li class="fragment"><p>Pero no sabemos en que direcci√≥n sucede esta afectacci√≥n (¬øreduce o incrementa el tiempo de metaformosis?).</p></li>
<li class="fragment"><p>Para responder estas pregunta, nos ayudaremos de las comparaciones m√∫ltiples.</p></li>
<li class="fragment"><p>Pero antes, le daremos un vistazo a otra herramienta com√∫nmente usada: los gr√°ficos de interacci√≥n.</p></li>
</ul>
</div>
</div>
</section>
<section id="gr√°ficos-de-interacci√≥n" class="slide level2">
<h2>Gr√°ficos de interacci√≥n</h2>
<div>
<ul>
<li class="fragment"><p>Es una forma de representar las predicciones lineales de un modelo con respecto a los niveles de sus factores.</p></li>
<li class="fragment"><p>Es recomendable usarlos con factores de hasta 3 niveles y en ANOVAS de dos factores.</p></li>
<li class="fragment"><p>Existen diversas formas de realizarlos en R:</p>
<ul>
<li class="fragment"><p>Librer√≠a base de R</p></li>
<li class="fragment"><p>Construirlos desde cero con <code>ggplot2</code></p></li>
<li class="fragment"><p>Usar librer√≠as accesorias de <code>ggplot2</code>. <span class="fragment">Para este caso, usaremos esta opci√≥n con la librer√≠a <code>interactions</code></span></p></li>
</ul></li>
</ul>
</div>
</section>
<section id="gr√°ficos-de-interacci√≥n-en-r" class="slide level2 scrollable">
<h2>Gr√°ficos de interacci√≥n en R</h2>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb119-2"><a href="#cb119-2"></a>graf_inter1 <span class="ot">&lt;-</span> <span class="fu">cat_plot</span>(</span>
<span id="cb119-3"><a href="#cb119-3"></a>  lm4,</span>
<span id="cb119-4"><a href="#cb119-4"></a>  <span class="at">pred =</span> Pred,</span>
<span id="cb119-5"><a href="#cb119-5"></a>  <span class="at">modx =</span> Res,</span>
<span id="cb119-6"><a href="#cb119-6"></a>  <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb119-7"><a href="#cb119-7"></a>  <span class="at">data =</span> ranas</span>
<span id="cb119-8"><a href="#cb119-8"></a>)</span>
<span id="cb119-9"><a href="#cb119-9"></a>graf_inter1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-81-1.png" width="960"></p>
</div>
</div>
</div>
</div>
<div class="columns">
<div class="column fragment" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb120-2"><a href="#cb120-2"></a>graf_inter2 <span class="ot">&lt;-</span> <span class="fu">cat_plot</span>(</span>
<span id="cb120-3"><a href="#cb120-3"></a>  lm4,</span>
<span id="cb120-4"><a href="#cb120-4"></a>  <span class="at">pred =</span> Res,</span>
<span id="cb120-5"><a href="#cb120-5"></a>  <span class="at">modx =</span> Pred,</span>
<span id="cb120-6"><a href="#cb120-6"></a>  <span class="at">geom =</span> <span class="st">"line"</span>,</span>
<span id="cb120-7"><a href="#cb120-7"></a>  <span class="at">data =</span> ranas</span>
<span id="cb120-8"><a href="#cb120-8"></a>)</span>
<span id="cb120-9"><a href="#cb120-9"></a>graf_inter2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column fragment" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-83-1.png" width="960"></p>
</div>
</div>
</div>
</div>
</section>
<section id="comparaciones-m√∫ltiples-5" class="slide level2 smaller scrollable">
<h2>Comparaciones m√∫ltiples</h2>
<div>
<ul>
<li class="fragment"><p>Las comparaciones m√∫ltiples en ANOVAS de m√∫ltiples v√≠as son ligeramente m√°s complejos.</p></li>
<li class="fragment"><p>La forma de llevarlas a cabo es ver a cada uno de los factores a la vez a lo largo de los niveles del otro.</p></li>
<li class="fragment"><p>En <code>emmeans</code> esto se hace indicando en el argumento <code>specs</code> el factor del que queremos ver las diferencias y con el argumento <code>by</code> el factor sobre el cual veremos a lo largo las differencias del primero.</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>ph2 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm4, <span class="at">specs =</span> <span class="st">"Pred"</span>, <span class="at">by =</span> <span class="st">"Res"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb121-2"><a href="#cb121-2"></a><span class="fu">pairs</span>(ph2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Res = Hi:
 contrast ratio     SE df null t.ratio p.value
 C / L    1.224 0.0985 72    1   2.512  0.0374
 C / NL   1.055 0.1088 72    1   0.515  0.8644
 L / NL   0.861 0.0889 72    1  -1.445  0.3234

Res = Lo:
 contrast ratio     SE df null t.ratio p.value
 C / L    1.625 0.1308 72    1   6.030  &lt;.0001
 C / NL   1.167 0.1205 72    1   1.500  0.2968
 L / NL   0.718 0.0741 72    1  -3.204  0.0057

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1"></a>ph3 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm4, <span class="at">specs =</span> <span class="st">"Res"</span>, <span class="at">by =</span> <span class="st">"Pred"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb123-2"><a href="#cb123-2"></a><span class="fu">pairs</span>(ph3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Pred = C:
 contrast ratio     SE df null t.ratio p.value
 Hi / Lo  0.644 0.0518 72    1  -5.470  &lt;.0001

Pred = L:
 contrast ratio     SE df null t.ratio p.value
 Hi / Lo  0.855 0.0688 72    1  -1.951  0.0549

Pred = NL:
 contrast ratio     SE df null t.ratio p.value
 Hi / Lo  0.713 0.0867 72    1  -2.782  0.0069

Tests are performed on the log scale </code></pre>
</div>
</div>
</div>
</section>
<section id="comparaciones-m√∫ltiples-6" class="slide level2 smaller scrollable" data-visibility="uncounted">
<h2>Comparaciones m√∫ltiples</h2>
<div>
<ul>
<li class="fragment"><p>Esta forma de llevar a cabo las comparaciones es f√°cil de implementar con dos factores.</p></li>
<li class="fragment"><p>Pero, sabemos que nos gustan las tablas con n√∫meros indicando los grupos!</p></li>
<li class="fragment"><p>Para llevar a cabo esto, tenemos que emplear un ‚Äútruco‚Äù:</p>
<ul>
<li class="fragment"><p>Re-estructurar el dise√±o para que tenga la forma de un ANOVA de una v√≠a. <span class="fragment">Esta es de hecho la forma en que tambi√©n conseguimos el llevar a cabo pruebas de Kruskal-Wallis sobre dise√±os originalmente factoriales.</span></p></li>
<li class="fragment"><p>Correr un nuevo modelo sobre este dise√±o</p></li>
<li class="fragment"><p>Seguir el proceso de comparaciones m√∫ltiples que ya vimos para el ANOVA de una v√≠a.</p></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a><span class="co"># creamos una variable dummy que combine los niveles de los factores</span></span>
<span id="cb125-2"><a href="#cb125-2"></a>ranas<span class="sc">$</span>tratamiento <span class="ot">&lt;-</span> <span class="fu">paste</span>(ranas<span class="sc">$</span>Pred, ranas<span class="sc">$</span>Res, <span class="at">sep =</span> <span class="st">"-"</span>)</span>
<span id="cb125-3"><a href="#cb125-3"></a></span>
<span id="cb125-4"><a href="#cb125-4"></a><span class="co"># corremos el modelo nuevamente con esta variable como predictor</span></span>
<span id="cb125-5"><a href="#cb125-5"></a>lm5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(Age.DPO) <span class="sc">~</span> tratamiento, <span class="at">data =</span> ranas)</span>
<span id="cb125-6"><a href="#cb125-6"></a></span>
<span id="cb125-7"><a href="#cb125-7"></a><span class="co"># usamos emmeans para calcular las comparaciones HSD Tukey</span></span>
<span id="cb125-8"><a href="#cb125-8"></a>ph3 <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(lm5, <span class="at">specs =</span> <span class="st">"tratamiento"</span>, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb125-9"><a href="#cb125-9"></a></span>
<span id="cb125-10"><a href="#cb125-10"></a><span class="co"># creamos la tabla con nuestras amados n√∫meros indicando el grupo</span></span>
<span id="cb125-11"><a href="#cb125-11"></a><span class="fu">cld</span>(ph3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code> tratamiento response   SE df lower.CL upper.CL .group
 L-Hi            47.1 2.68 72     42.0     52.7  1    
 NL-Hi           54.7 4.70 72     46.0     64.9  12   
 L-Lo            55.1 3.14 72     49.2     61.7  1    
 C-Hi            57.6 3.28 72     51.5     64.6  12   
 NL-Lo           76.7 6.60 72     64.6     91.0   23  
 C-Lo            89.5 5.10 72     79.9    100.3    3  

Confidence level used: 0.95 
Intervals are back-transformed from the log scale 
P value adjustment: tukey method for comparing a family of 6 estimates 
Tests are performed on the log scale 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</div>
</section>
<section id="ejercicios-4.10" class="slide level2">
<h2>Ejercicios 4.10</h2>
<ul>
<li><p>Lleva a cabo un ANOVA de dos v√≠as para las variables <code>Resorb.days</code> y los factores <code>Pred</code> y <code>Res</code>. La pregunta a investigar es saber si existe una interacci√≥n entre la presencia de predadores a distintos niveles de recursos que afecte el tiempo de reabsorci√≥n de la cola en los renacuajos de ranas arb√≥reas de ojos rojos.</p></li>
<li><p>A pesar de que el modelo para <code>Resorb.day</code> que acabas de hacer cumple con los supuestos del ANOVA, solo por aprendizaje, conduce una prueba de Kruskal-Wallis usando los mismos factores.</p></li>
<li><p>¬øC√≥mo implementar√≠as un DBCA factorial con estos datos?</p></li>
</ul>
</section></section>
<section>
<section id="regresi√≥n-lineal" class="title-slide slide level1 center">
<h1>Regresi√≥n lineal</h1>

</section>
<section id="introducci√≥n-1" class="slide level2 smaller">
<h2>Introducci√≥n</h2>
<div>
<ul>
<li class="fragment"><p>Otro modelo estad√≠stico ampliamente usado es la regresi√≥n lineal.</p></li>
<li class="fragment"><p>Se diferencia del ANOVA al considerar un predictor continuo (no un factor categ√≥rico).</p></li>
<li class="fragment"><p>Los supuestos de la regresi√≥n lineal son:</p>
<ul>
<li class="fragment"><p>Existencia de una relaci√≥n lineal entre las variables continuas objeto de la regresi√≥n</p></li>
<li class="fragment"><p>Normalidad de los residuales</p></li>
<li class="fragment"><p>Que no exista multicolinearidad (en el caso de regresi√≥n m√∫ltiple)</p></li>
<li class="fragment"><p>Que no exista auto correlaci√≥n (que las observaciones no dependan una de otra dentro de una misma variable)</p></li>
<li class="fragment"><p>Homogeneidad de la varianza de los residuales</p></li>
</ul></li>
<li class="fragment"><p>Contrario al ANOVA, no existen correcciones o m√©todos alternativos cuando las transformaciones fallan.</p></li>
<li class="fragment"><p>Por esto, lo que se recomienda hacer es mencionar todos los detalles de la conducci√≥n del modelo. <span class="fragment">Cosa que rara vez pasa.</span></p></li>
<li class="fragment"><p>En regresi√≥n lineal es quiz√° en el m√©todo que m√°s se abusa del remover outliers.</p></li>
</ul>
</div>
</section>
<section id="regresi√≥n-lineal-en-r" class="slide level2 smaller scrollable">
<h2>Regresi√≥n lineal en R</h2>
<div>
<ul>
<li class="fragment"><p>Usando los datos de Touchon, podr√≠amos preguntarnos si el tama√±o de las ranas al final de la metamorfosis <code>SVL.final</code> est√° influenciado por la edad en finalizar la metamorfosis <code>Age.DPO</code>.</p></li>
<li class="fragment"><p>Para minimizar el incumplimiento de los supuestos de la regresi√≥n lineal, hagamos de cuenta que con anterioridad encontramos que usando el logaritmo en ambas normaliza al menos los residuales.</p></li>
<li class="fragment"><p>Esta regresi√≥n lineal ser√≠a de la siguiente forma:</p></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a>lm6 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(SVL.final) <span class="sc">~</span> <span class="fu">log</span>(Age.DPO), <span class="at">data =</span> ranas)</span>
<span id="cb127-2"><a href="#cb127-2"></a><span class="fu">summary</span>(lm6)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(SVL.final) ~ log(Age.DPO), data = ranas)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.182298 -0.049070  0.000516  0.038342  0.159057 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.44001    0.09211  37.345  &lt; 2e-16 ***
log(Age.DPO) -0.11624    0.02232  -5.208 1.58e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.06244 on 76 degrees of freedom
Multiple R-squared:  0.263, Adjusted R-squared:  0.2533 
F-statistic: 27.12 on 1 and 76 DF,  p-value: 1.581e-06</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Ahora d√©mole un vistazo a los diagn√≥sticos:</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-90-1.png" width="576"></p>
</div>
</div>
<div>
<ol type="1">
<li class="fragment"><p><strong>Residuales vs.&nbsp;Valores Ajustados</strong>: Sirve para chequear la relaci√≥n lineal entre las variables.</p></li>
<li class="fragment"><p><strong>Gr√°fico Q-Q</strong>: Sirve para chequear la normalidad de los residuales.</p></li>
<li class="fragment"><p><strong>Escala Localizaci√≥n</strong>: Sirve para chequear la homocedasticidad (homogeneidad de las variables).</p></li>
<li class="fragment"><p><strong>Residuales y apalancamiento</strong>: Sirve para identificar outliers</p></li>
</ol>
</div>
</div>
</section>
<section id="interpretaci√≥n-de-la-regresi√≥n-lineal" class="slide level2 smaller scrollable">
<h2>Interpretaci√≥n de la regresi√≥n lineal</h2>
<div class="fragment">
<p><span class="math display">\[
y = mx + b
\]</span></p>
</div>
<div class="fragment">
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log(SVL.final) ~ log(Age.DPO), data = ranas)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.182298 -0.049070  0.000516  0.038342  0.159057 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   3.44001    0.09211  37.345  &lt; 2e-16 ***
log(Age.DPO) -0.11624    0.02232  -5.208 1.58e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.06244 on 76 degrees of freedom
Multiple R-squared:  0.263, Adjusted R-squared:  0.2533 
F-statistic: 27.12 on 1 and 76 DF,  p-value: 1.581e-06</code></pre>
</div>
</div>
</div>
<div class="fragment">
<ul>
<li>Por cada incremento en una unidad del logaritmo de <code>Age.DPO</code>, tenemos una unidad en descenso del logaritmo de <code>SVL.final</code></li>
</ul>
</div>
<div class="fragment">
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">ggplot</span>(ranas, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(Age.DPO), <span class="at">y =</span> <span class="fu">log</span>(SVL.final))) <span class="sc">+</span></span>
<span id="cb130-2"><a href="#cb130-2"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb130-3"><a href="#cb130-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="index_files/figure-revealjs/unnamed-chunk-92-1.png" width="960"></p>
</div>
</div>
</div>
</section></section>
<section>
<section id="antes-de-terminar" class="title-slide slide level1 center">
<h1>¬°Antes de terminar!</h1>

</section>
<section id="el-m√°gico-r2" class="slide level2">
<h2>El m√°gico <span class="math inline">\(R^2\)</span></h2>

<img data-src="images/vieja.jpg" class="r-stretch quarto-figure-center"></section>
<section id="el-m√°gico-r2-1" class="slide level2 smaller" data-visibility="uncounted">
<h2>El m√°gico <span class="math inline">\(R^2\)</span></h2>
<div>
<ul>
<li class="fragment"><p>Quiz√° muchos hayan escuchado que un <span class="math inline">\(R^2\)</span> cercano a 1 es ‚Äúideal‚Äù cuando realizamos una regresi√≥n lineal.</p></li>
<li class="fragment"><p>Recuerdo incluso haber sido indoctrinado acerca de m√°rgenes para un buen <span class="math inline">\(R^2\)</span> (algo as√≠ como que por encima del 80% es ‚Äúbueno‚Äù, mayor al 90% es excelente y 100% es el Nirvana).</p></li>
<li class="fragment"><p>En breve, <span class="math inline">\(R^2\)</span> <strong>NO ES NINGUNA DE LAS SIGUIENTES COSAS</strong>:</p>
<ul>
<li class="fragment"><p>Una m√©trica de bondad de ajuste<span class="fragment">: no nos dice si el modelo se ajusta bien a los datos.</span></p></li>
<li class="fragment"><p>Una m√©trica del error de predicci√≥n<span class="fragment">: no mide para nada que tan bueno es el modelo para predecir futuras observaciones.</span></p></li>
<li class="fragment"><p>Una m√©trica que permita comparar modelos usando variables transformadas<span class="fragment">: es com√∫n jugar a transformar los datos para ver de que manera se puede inflarlo hacia el santo grial.</span></p></li>
<li class="fragment"><p>Una m√©trica que permita que tan bien una variable explica otra<span class="fragment">: en el ejemplo que vimos, y en toda regresi√≥n lineal, si cambiamos el predictor por respuesta y viceversa, tendremos exactamente el mismo <span class="math inline">\(R^2\)</span></span></p></li>
</ul></li>
<li class="fragment"><p><span class="math inline">\(R^2\)</span> es simplemente una medida de la cantidad de variaci√≥n que un modelo espec√≠fico explica. <span class="fragment">¬øTiene alguna utilidad pr√°ctica?</span> <span class="fragment">no lo s√©, en 10 a√±os como estad√≠stico no lo he usado nunca, al menos no, voluntariamente‚Ä¶</span></p></li>
</ul>
</div>
</section>
<section id="el-m√°gico-r2-2" class="slide level2 smaller" data-visibility="uncounted">
<h2>El m√°gico <span class="math inline">\(R^2\)</span></h2>
<div class="fragment">
<ul>
<li>Lo que visto es carnicer√≠as de datos por inflar <span class="math inline">\(R^2\)</span> debido a esta mala interpretaci√≥n que no se sabe su origen exacto (<a href="https://psycnet.apa.org/record/1946-01733-001" target="_blank">pero quiz√° aqu√≠ uno de tantos culpables perdidos en la historia</a>).</li>
</ul>
</div>
<div class="fragment">
<ul>
<li><p>Ac√° les dejo unos cuantos recursos que pueden revisar en m√°s detalle si les interesa:</p>
<ul>
<li><p><a href="https://www.jstor.org/stable/2111095?casa_token=F0Om3ZPkjE4AAAAA%3AvR0lcSXuNHICl21EYDAoXSerVhME0AO_ZvkzayO1vYT6R3cCM9Ooy6-P9Wa6AEZN1Gcm960rjGFM9JVA4AJc4lm-nswzYJxdtiKr03H4tbVMRW16e35TlA" target="_blank">El paper ‚ÄúHow not to lie with Statistics: Avoiding common mistakes in Quantitative Political Science‚Äù</a> Un art√≠culo extenso pero que contiene una secci√≥n dedicada a desmitificar esta mala pr√°ctica.</p></li>
<li><p><a href="https://www.stat.cmu.edu/~cshalizi/mreg/15/lectures/10/lecture-10.pdf" target="_blank">Las notas de la clase del Prof.&nbsp;Cosma Shalizi de la Universidad Carnegie Mellon</a> donde hermosamente destruye los mitos en torno al <span class="math inline">\(R^2\)</span> citando f√≥rmulas y principios estad√≠sticos.</p></li>
<li><p><a href="https://data.library.virginia.edu/is-r-squared-useless/" target="_blank">Un blog de Clay Ford, consultor estad√≠stico de la Universidad de Virginia</a> donde demuestra con R que valores de <span class="math inline">\(R^2\)</span> cercanos a 0 no necesariamente implican un mal modelo, ni valores cercanos 1 son indicativo de modelos destacados.</p></li>
</ul></li>
</ul>
</div>
</section></section>
<section id="gracias" class="title-slide slide level1 center">
<h1>¬°Gracias!</h1>


<img src="images/logo.jpeg" class="slide-logo r-stretch"><div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="site_libs/revealjs/plugin/reveal-pointer/pointer.js"></script>
  <script src="site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="site_libs/revealjs/plugin/search/search.js"></script>
  <script src="site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false,"theme":"whiteboard","boardmarkerWidth":4},
'pointer': {"key":"q","color":"red","pointerSize":16,"alwaysVisible":false},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1366,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, RevealPointer, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>